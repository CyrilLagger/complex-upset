<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Examples - R • ComplexUpset</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Examples - R">
<meta property="og:description" content="ComplexUpset">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@krassowski">
<meta name="twitter:site" content="@krassowski">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ComplexUpset</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Examples_Python.html">Examples - Python</a>
    </li>
    <li>
      <a href="../articles/Examples_R.html">Examples - R</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/krassowski/complex-upset/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Examples_R_files/header-attrs-2.5/header-attrs.js"></script><script src="Examples_R_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="Examples_R_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="Examples_R_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Examples - R</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/krassowski/complex-upset/blob/master/vignettes/Examples_R.Rmd"><code>vignettes/Examples_R.Rmd</code></a></small>
      <div class="hidden name"><code>Examples_R.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/krassowski/complex-upset">ComplexUpset</a></span><span class="op">)</span></code></pre></div>
<div id="prepare-the-datasets" class="section level2">
<h2 class="hasAnchor">
<a href="#prepare-the-datasets" class="anchor"></a>Prepare the datasets</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">movies</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu">ggplot2movies</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ggplot2movies/man/movies.html">movies</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">movies</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>
A data.frame: 3 × 24
</caption>
<thead>
<tr>
<th>
</th>
<th scope="col">
title
</th>
<th scope="col">
year
</th>
<th scope="col">
length
</th>
<th scope="col">
budget
</th>
<th scope="col">
rating
</th>
<th scope="col">
votes
</th>
<th scope="col">
r1
</th>
<th scope="col">
r2
</th>
<th scope="col">
r3
</th>
<th scope="col">
r4
</th>
<th scope="col">
⋯
</th>
<th scope="col">
r9
</th>
<th scope="col">
r10
</th>
<th scope="col">
mpaa
</th>
<th scope="col">
Action
</th>
<th scope="col">
Animation
</th>
<th scope="col">
Comedy
</th>
<th scope="col">
Drama
</th>
<th scope="col">
Documentary
</th>
<th scope="col">
Romance
</th>
<th scope="col">
Short
</th>
</tr>
<tr>
<th>
</th>
<th scope="col">
&lt;chr&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
⋯
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;chr&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
</tr>
</thead>
<tbody>
<tr>
<th scope="row">
1
</th>
<td>
$
</td>
<td>
1971
</td>
<td>
121
</td>
<td>
NA
</td>
<td>
6.4
</td>
<td>
348
</td>
<td>
4.5
</td>
<td>
4.5
</td>
<td>
4.5
</td>
<td>
4.5
</td>
<td>
⋯
</td>
<td>
4.5
</td>
<td>
4.5
</td>
<td>
</td>
<td>
0
</td>
<td>
0
</td>
<td>
1
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
</tr>
<tr>
<th scope="row">
2
</th>
<td>
$1000 a Touchdown
</td>
<td>
1939
</td>
<td>
71
</td>
<td>
NA
</td>
<td>
6.0
</td>
<td>
20
</td>
<td>
0.0
</td>
<td>
14.5
</td>
<td>
4.5
</td>
<td>
24.5
</td>
<td>
⋯
</td>
<td>
4.5
</td>
<td>
14.5
</td>
<td>
</td>
<td>
0
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
</tr>
<tr>
<th scope="row">
3
</th>
<td>
$21 a Day Once a Month
</td>
<td>
1941
</td>
<td>
7
</td>
<td>
NA
</td>
<td>
8.2
</td>
<td>
5
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
⋯
</td>
<td>
24.5
</td>
<td>
24.5
</td>
<td>
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
1
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genres</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">movies</span><span class="op">)</span><span class="op">[</span><span class="fl">18</span><span class="op">:</span><span class="fl">24</span><span class="op">]</span>
<span class="va">genres</span></code></pre></div>
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline">
<li>
‘Action’
</li>
<li>
‘Animation’
</li>
<li>
‘Comedy’
</li>
<li>
‘Drama’
</li>
<li>
‘Documentary’
</li>
<li>
‘Romance’
</li>
<li>
‘Short’
</li>
</ol>
<p>Convert the genre indicator columns to use boolean values:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">movies</span><span class="op">[</span><span class="va">genres</span><span class="op">]</span> <span class="op">=</span> <span class="va">movies</span><span class="op">[</span><span class="va">genres</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span>
<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">movies</span><span class="op">[</span><span class="va">genres</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>
A matrix: 7 × 3 of type lgl
</caption>
<thead><tr>
<th>
</th>
<th scope="col">
1
</th>
<th scope="col">
2
</th>
<th scope="col">
3
</th>
</tr></thead>
<tbody>
<tr>
<th scope="row">
Action
</th>
<td>
FALSE
</td>
<td>
FALSE
</td>
<td>
FALSE
</td>
</tr>
<tr>
<th scope="row">
Animation
</th>
<td>
FALSE
</td>
<td>
FALSE
</td>
<td>
TRUE
</td>
</tr>
<tr>
<th scope="row">
Comedy
</th>
<td>
TRUE
</td>
<td>
TRUE
</td>
<td>
FALSE
</td>
</tr>
<tr>
<th scope="row">
Drama
</th>
<td>
TRUE
</td>
<td>
FALSE
</td>
<td>
FALSE
</td>
</tr>
<tr>
<th scope="row">
Documentary
</th>
<td>
FALSE
</td>
<td>
FALSE
</td>
<td>
FALSE
</td>
</tr>
<tr>
<th scope="row">
Romance
</th>
<td>
FALSE
</td>
<td>
FALSE
</td>
<td>
FALSE
</td>
</tr>
<tr>
<th scope="row">
Short
</th>
<td>
FALSE
</td>
<td>
FALSE
</td>
<td>
TRUE
</td>
</tr>
</tbody>
</table>
<p>To keep the examples fast to complie we will operate on a subset of the movies with complete data:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">movies</span><span class="op">[</span><span class="va">movies</span><span class="op">$</span><span class="va">mpaa</span> <span class="op">==</span> <span class="st">''</span>, <span class="st">'mpaa'</span><span class="op">]</span> <span class="op">=</span> <span class="cn">NA</span>
<span class="va">movies</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">movies</span><span class="op">)</span></code></pre></div>
<p>Utility for changing output parameters in Jupyter notebooks (<a href="https://github.com/IRkernel/IRkernel">IRKernel kernel</a>), not relevant if using RStudio or scripting R from terminal:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">set_size</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">w</span>, <span class="va">h</span>, <span class="va">factor</span><span class="op">=</span><span class="fl">1.5</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">s</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">*</span> <span class="va">factor</span>
    <span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>
        repr.plot.width<span class="op">=</span><span class="va">w</span> <span class="op">*</span> <span class="va">s</span>,
        repr.plot.height<span class="op">=</span><span class="va">h</span> <span class="op">*</span> <span class="va">s</span>,
        repr.plot.res<span class="op">=</span><span class="fl">100</span> <span class="op">/</span> <span class="va">factor</span>,
        jupyter.plot_mimetypes<span class="op">=</span><span class="st">'image/png'</span>,
        jupyter.plot_scale<span class="op">=</span><span class="fl">1</span>
    <span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="basic-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-usage" class="anchor"></a>0. Basic usage</h2>
<p>There are two required arguments:</p>
<ul>
<li>the first argument is expected to be a dataframe with both group indicator variables and covariates,</li>
<li>the second argument specifies a list with names of column which indicate the group membership.</li>
</ul>
<p>Additional arguments can be provided, such as <code>name</code> (specifies xlab for intersection matrix) or <code>width_ratio</code> (specifies how much space should be occupied by the set size panel). Other such arguments are discussed at length later in this document.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_12_0.png"></p>
<div id="selecting-intersections" class="section level3">
<h3 class="hasAnchor">
<a href="#selecting-intersections" class="anchor"></a>0.1 Selecting intersections</h3>
<p>We will focus on the intersections with at least ten members <code>(min_size=10)</code> and on a few variables which are significantly different between the intersections (see 2. Running statistical tests).</p>
<p>When using <code>min_size</code>, the empty groups will be skipped by default (e.g. <em>Short</em> movies would have no overlap with size of 10). To keep all groups pass <code>keep_empty_groups=TRUE</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>
<span class="op">(</span>
    <span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, min_size<span class="op">=</span><span class="fl">10</span>, wrap<span class="op">=</span><span class="cn">TRUE</span>, set_sizes<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">'Without empty groups (Short dropped)'</span><span class="op">)</span>
    <span class="op">+</span>    <span class="co"># adding plots is possible thanks to patchwork</span>
    <span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, min_size<span class="op">=</span><span class="fl">10</span>, keep_empty_groups<span class="op">=</span><span class="cn">TRUE</span>, wrap<span class="op">=</span><span class="cn">TRUE</span>, set_sizes<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">'With empty groups'</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_15_0.png"></p>
<p>When empty columns are detected a warning will be issued. The silence it, pass <code>warn_when_dropping_groups=FALSE</code>. Complimentary <code>max_size</code> can be used in tandem.</p>
<p>You can also select intersections by degree (<code>min_degree</code> and <code>max_degree</code>):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>,
    min_degree<span class="op">=</span><span class="fl">3</span>,
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_18_0.png"></p>
<p>Or request a constant number of intersections with <code>n_intersections</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>,
    n_intersections<span class="op">=</span><span class="fl">15</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_20_0.png"></p>
</div>
</div>
<div id="adding-components" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-components" class="anchor"></a>1. Adding components</h2>
<p>We can add multiple annotation components (also called panels):</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">8</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>   <span class="co"># keep the same jitter for identical plots</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    annotations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Length'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">intersection</span>, y<span class="op">=</span><span class="va">length</span><span class="op">)</span>,
            geom<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span>
        <span class="op">)</span>,
        <span class="st">'Rating'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">intersection</span>, y<span class="op">=</span><span class="va">rating</span><span class="op">)</span>,
            geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
                <span class="co"># checkout ggbeeswarm::geom_quasirandom for better results!</span>
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">votes</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>
            <span class="op">)</span>
        <span class="op">)</span>,
        <span class="st">'Budget'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">intersection</span>, y<span class="op">=</span><span class="va">budget</span><span class="op">)</span>,
            geom<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_23_0.png"></p>
<p>For simple annotations, such as the length above, you can use a shorthand notation of <code>upset_annotate</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">6</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    annotations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Length'</span><span class="op">=</span><span class="fu"><a href="../reference/upset_annotate.html">upset_annotate</a></span><span class="op">(</span><span class="st">'length'</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,
        <span class="st">'Budget'</span><span class="op">=</span><span class="fu"><a href="../reference/upset_annotate.html">upset_annotate</a></span><span class="op">(</span><span class="st">'budget'</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_25_0.png"></p>
<p>You can also use barplots to demonstrate differences in proportions of categorical variables:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">5</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    annotations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'MPAA Raiting'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">intersection</span>, fill<span class="op">=</span><span class="va">mpaa</span><span class="op">)</span>,
            geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">'count'</span>, position<span class="op">=</span><span class="st">'fill'</span><span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
                    <span class="st">'R'</span><span class="op">=</span><span class="st">'#E41A1C'</span>, <span class="st">'PG'</span><span class="op">=</span><span class="st">'#377EB8'</span>,
                    <span class="st">'PG-13'</span><span class="op">=</span><span class="st">'#4DAF4A'</span>, <span class="st">'NC-17'</span><span class="op">=</span><span class="st">'#FF7F00'</span>
                <span class="op">)</span><span class="op">)</span>
            <span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_27_0.png"></p>
</div>
<div id="running-statistical-tests" class="section level2">
<h2 class="hasAnchor">
<a href="#running-statistical-tests" class="anchor"></a>2. Running statistical tests</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/upset_test.html">upset_test</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span><span class="op">)</span></code></pre></div>
<pre><code>[1] "year, length, budget, rating, votes, r1, r2, r3, r4, r5, r6, r7, r8, r9, r10, mpaa differ significantly between intersections"</code></pre>
<table class="table">
<caption>
A data.frame: 17 × 5
</caption>
<thead>
<tr>
<th>
</th>
<th scope="col">
variable
</th>
<th scope="col">
p.value
</th>
<th scope="col">
statistic
</th>
<th scope="col">
test
</th>
<th scope="col">
fdr
</th>
</tr>
<tr>
<th>
</th>
<th scope="col">
&lt;chr&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;chr&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
</tr>
</thead>
<tbody>
<tr>
<th scope="row">
length
</th>
<td>
length
</td>
<td>
6.511525e-71
</td>
<td>
422.88444
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.106959e-69
</td>
</tr>
<tr>
<th scope="row">
rating
</th>
<td>
rating
</td>
<td>
1.209027e-46
</td>
<td>
301.72764
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.027673e-45
</td>
</tr>
<tr>
<th scope="row">
budget
</th>
<td>
budget
</td>
<td>
3.899860e-44
</td>
<td>
288.97476
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
2.209921e-43
</td>
</tr>
<tr>
<th scope="row">
r8
</th>
<td>
r8
</td>
<td>
9.900004e-39
</td>
<td>
261.28815
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
4.207502e-38
</td>
</tr>
<tr>
<th scope="row">
mpaa
</th>
<td>
mpaa
</td>
<td>
3.732200e-35
</td>
<td>
242.77939
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.268948e-34
</td>
</tr>
<tr>
<th scope="row">
r9
</th>
<td>
r9
</td>
<td>
1.433256e-30
</td>
<td>
218.78160
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
4.060891e-30
</td>
</tr>
<tr>
<th scope="row">
r1
</th>
<td>
r1
</td>
<td>
2.211600e-23
</td>
<td>
180.32740
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
5.371029e-23
</td>
</tr>
<tr>
<th scope="row">
r4
</th>
<td>
r4
</td>
<td>
1.008119e-18
</td>
<td>
154.62772
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
2.142254e-18
</td>
</tr>
<tr>
<th scope="row">
r3
</th>
<td>
r3
</td>
<td>
2.568227e-17
</td>
<td>
146.70217
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
4.851095e-17
</td>
</tr>
<tr>
<th scope="row">
r5
</th>
<td>
r5
</td>
<td>
9.823827e-16
</td>
<td>
137.66310
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.670051e-15
</td>
</tr>
<tr>
<th scope="row">
r7
</th>
<td>
r7
</td>
<td>
9.201549e-14
</td>
<td>
126.19243
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.422058e-13
</td>
</tr>
<tr>
<th scope="row">
r2
</th>
<td>
r2
</td>
<td>
2.159955e-13
</td>
<td>
124.00604
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
3.059936e-13
</td>
</tr>
<tr>
<th scope="row">
r10
</th>
<td>
r10
</td>
<td>
1.283470e-11
</td>
<td>
113.38113
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.678384e-11
</td>
</tr>
<tr>
<th scope="row">
votes
</th>
<td>
votes
</td>
<td>
2.209085e-10
</td>
<td>
105.79588
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
2.682460e-10
</td>
</tr>
<tr>
<th scope="row">
r6
</th>
<td>
r6
</td>
<td>
3.779129e-05
</td>
<td>
70.80971
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
4.283013e-05
</td>
</tr>
<tr>
<th scope="row">
year
</th>
<td>
year
</td>
<td>
2.745818e-02
</td>
<td>
46.55972
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
2.917431e-02
</td>
</tr>
<tr>
<th scope="row">
title
</th>
<td>
title
</td>
<td>
2.600003e-01
</td>
<td>
34.53375
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
2.600003e-01
</td>
</tr>
</tbody>
</table>
<p><code>Kruskal-Wallis rank sum test</code> is not always the best choice.</p>
<p>You can either change the test for:</p>
<ul>
<li>all the variables (<code>test=your.test</code>), or</li>
<li>specific variables (using <code>tests=list(variable=some.test)</code> argument)</li>
</ul>
<p>The tests are called with <code>(formula=variable ~ intersection, data)</code> signature, such as accepted by <code>kruskal.test</code>. The result is expected to be a list with following members:</p>
<ul>
<li><code>p.value</code></li>
<li><code>statistic</code></li>
<li><code>method</code></li>
</ul>
<p>It is easy to adapt tests which do not obey this signature/output convention; for example the Chi-squared test and anova can be wrapped with two-line functions as follows:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">chisq_from_formula</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span>
        <span class="fu"><a href="https://rdrr.io/r/stats/ftable.html">ftable</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span><span class="op">)</span>
    <span class="op">)</span>
<span class="op">}</span>

<span class="va">anova_single</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">result</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        p.value<span class="op">=</span><span class="va">result</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">'Pr(&gt;F)'</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,
        method<span class="op">=</span><span class="st">'Analysis of variance Pr(&gt;F)'</span>,
        statistic<span class="op">=</span><span class="va">result</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">'F value'</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
    <span class="op">)</span>
<span class="op">}</span>

<span class="va">custom_tests</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    mpaa<span class="op">=</span><span class="va">chisq_from_formula</span>,
    budget<span class="op">=</span><span class="va">anova_single</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/upset_test.html">upset_test</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, tests<span class="op">=</span><span class="va">custom_tests</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>Warning message in chisq.test(ftable(formula, data)):
“Chi-squared approximation may be incorrect”


[1] "year, length, budget, rating, votes, r1, r2, r3, r4, r5, r6, r7, r8, r9, r10, mpaa differ significantly between intersections"</code></pre>
<table class="table">
<caption>
A data.frame: 6 × 5
</caption>
<thead>
<tr>
<th>
</th>
<th scope="col">
variable
</th>
<th scope="col">
p.value
</th>
<th scope="col">
statistic
</th>
<th scope="col">
test
</th>
<th scope="col">
fdr
</th>
</tr>
<tr>
<th>
</th>
<th scope="col">
&lt;chr&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;chr&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
</tr>
</thead>
<tbody>
<tr>
<th scope="row">
length
</th>
<td>
length
</td>
<td>
6.511525e-71
</td>
<td>
422.88444
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.106959e-69
</td>
</tr>
<tr>
<th scope="row">
budget
</th>
<td>
budget
</td>
<td>
1.348209e-60
</td>
<td>
13.66395
</td>
<td>
Analysis of variance Pr(&gt;F)
</td>
<td>
1.145977e-59
</td>
</tr>
<tr>
<th scope="row">
rating
</th>
<td>
rating
</td>
<td>
1.209027e-46
</td>
<td>
301.72764
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
6.851151e-46
</td>
</tr>
<tr>
<th scope="row">
mpaa
</th>
<td>
mpaa
</td>
<td>
9.799097e-42
</td>
<td>
406.33814
</td>
<td>
Pearson’s Chi-squared test
</td>
<td>
4.164616e-41
</td>
</tr>
<tr>
<th scope="row">
r8
</th>
<td>
r8
</td>
<td>
9.900004e-39
</td>
<td>
261.28815
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
3.366002e-38
</td>
</tr>
<tr>
<th scope="row">
r9
</th>
<td>
r9
</td>
<td>
1.433256e-30
</td>
<td>
218.78160
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
4.060891e-30
</td>
</tr>
</tbody>
</table>
<p>Many tests will require at least two observations in each group. You can skip intersections with less than two members with <code>min_size=2</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bartlett_results</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="../reference/upset_test.html">upset_test</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, test<span class="op">=</span><span class="va">bartlett.test</span>, min_size<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">bartlett_results</span><span class="op">)</span></code></pre></div>
<pre><code>[1] "NA, year, length, budget, rating, votes, r1, r2, r3, r4, r5, r6, r7, r8, r9, r10, NA differ significantly between intersections"</code></pre>
<table class="table">
<caption>
A data.frame: 6 × 5
</caption>
<thead>
<tr>
<th>
</th>
<th scope="col">
variable
</th>
<th scope="col">
p.value
</th>
<th scope="col">
statistic
</th>
<th scope="col">
test
</th>
<th scope="col">
fdr
</th>
</tr>
<tr>
<th>
</th>
<th scope="col">
&lt;chr&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;chr&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
</tr>
</thead>
<tbody>
<tr>
<th scope="row">
year
</th>
<td>
year
</td>
<td>
1.041955e-67
</td>
<td>
386.53699
</td>
<td>
Bartlett test of homogeneity of variances
</td>
<td>
1.302444e-67
</td>
</tr>
<tr>
<th scope="row">
length
</th>
<td>
length
</td>
<td>
3.982729e-67
</td>
<td>
383.70148
</td>
<td>
Bartlett test of homogeneity of variances
</td>
<td>
4.595457e-67
</td>
</tr>
<tr>
<th scope="row">
budget
</th>
<td>
budget
</td>
<td>
7.637563e-50
</td>
<td>
298.89911
</td>
<td>
Bartlett test of homogeneity of variances
</td>
<td>
8.183103e-50
</td>
</tr>
<tr>
<th scope="row">
rating
</th>
<td>
rating
</td>
<td>
3.980194e-06
</td>
<td>
66.63277
</td>
<td>
Bartlett test of homogeneity of variances
</td>
<td>
3.980194e-06
</td>
</tr>
<tr>
<th scope="row">
title
</th>
<td>
title
</td>
<td>
NA
</td>
<td>
NA
</td>
<td>
Bartlett test of homogeneity of variances
</td>
<td>
NA
</td>
</tr>
<tr>
<th scope="row">
mpaa
</th>
<td>
mpaa
</td>
<td>
NA
</td>
<td>
NA
</td>
<td>
Bartlett test of homogeneity of variances
</td>
<td>
NA
</td>
</tr>
</tbody>
</table>
<div id="ignore-specific-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#ignore-specific-variables" class="anchor"></a>2.1 Ignore specific variables</h3>
<p>You may want to exclude variables which are:</p>
<ul>
<li>highly correlated and therefore interfering with the FDR calculation, or</li>
<li>simply irrelevant</li>
</ul>
<p>In the movies example, the title variable is not a reasonable thing to compare. We can ignore it using:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># note: title no longer present</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="fu"><a href="../reference/upset_test.html">upset_test</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, ignore<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'title'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>[1] "year, length, budget, rating, votes, r1, r2, r3, r4, r5, r6, r7, r8, r9, r10, mpaa differ significantly between intersections"</code></pre>
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline">
<li>
‘length’
</li>
<li>
‘rating’
</li>
<li>
‘budget’
</li>
<li>
‘r8’
</li>
<li>
‘mpaa’
</li>
<li>
‘r9’
</li>
<li>
‘r1’
</li>
<li>
‘r4’
</li>
<li>
‘r3’
</li>
<li>
‘r5’
</li>
<li>
‘r7’
</li>
<li>
‘r2’
</li>
<li>
‘r10’
</li>
<li>
‘votes’
</li>
<li>
‘r6’
</li>
<li>
‘year’
</li>
</ol>
</div>
</div>
<div id="adjusting-intersection-size" class="section level2">
<h2 class="hasAnchor">
<a href="#adjusting-intersection-size" class="anchor"></a>3. Adjusting “Intersection size”</h2>
<div id="counts" class="section level3">
<h3 class="hasAnchor">
<a href="#counts" class="anchor"></a>3.1 Counts</h3>
<p>The counts over the bars can be disabled:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    base_annotations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Intersection size'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span><span class="op">(</span>counts<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
    <span class="op">)</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_42_0.png"></p>
<p>The colors can be changed:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    base_annotations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Intersection size'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span><span class="op">(</span>
            text_colors<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
                on_background<span class="op">=</span><span class="st">'brown'</span>, on_bar<span class="op">=</span><span class="st">'yellow'</span>
            <span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_44_0.png"></p>
<p>Any parameter supported by <code>geom_text</code> can be passed in <code>text</code> list:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    base_annotations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Intersection size'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span><span class="op">(</span>
            text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
                vjust<span class="op">=</span><span class="op">-</span><span class="fl">0.1</span>,
                hjust<span class="op">=</span><span class="op">-</span><span class="fl">0.1</span>,
                angle<span class="op">=</span><span class="fl">45</span>
            <span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_46_0.png"></p>
</div>
<div id="fill-the-bars" class="section level3">
<h3 class="hasAnchor">
<a href="#fill-the-bars" class="anchor"></a>3.2 Fill the bars</h3>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    base_annotations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Intersection size'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span><span class="op">(</span>
            counts<span class="op">=</span><span class="cn">FALSE</span>,
            aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">mpaa</span><span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_48_0.png"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    base_annotations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Intersection size'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span><span class="op">(</span>
            counts<span class="op">=</span><span class="cn">FALSE</span>,
            aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">mpaa</span><span class="op">)</span>
        <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
            <span class="st">'R'</span><span class="op">=</span><span class="st">'#E41A1C'</span>, <span class="st">'PG'</span><span class="op">=</span><span class="st">'#377EB8'</span>,
            <span class="st">'PG-13'</span><span class="op">=</span><span class="st">'#4DAF4A'</span>, <span class="st">'NC-17'</span><span class="op">=</span><span class="st">'#FF7F00'</span>
        <span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_49_0.png"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    base_annotations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Intersection size'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span><span class="op">(</span>
            counts<span class="op">=</span><span class="cn">FALSE</span>,
            aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="st">'bars_color'</span><span class="op">)</span>
        <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'bars_color'</span><span class="op">=</span><span class="st">'blue'</span><span class="op">)</span>, guide<span class="op">=</span><span class="st">'none'</span><span class="op">)</span>
    <span class="op">)</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_50_0.png"></p>
</div>
<div id="adjusting-the-height-of-the-matrixintersection-size" class="section level3">
<h3 class="hasAnchor">
<a href="#adjusting-the-height-of-the-matrixintersection-size" class="anchor"></a>3.3 Adjusting the height of the matrix/intersection size</h3>
<p>Setting <code>height_ratio=1</code> will cause the intersection matrix and the intersection size to have an equal height:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    height_ratio<span class="op">=</span><span class="fl">1</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_53_0.png"></p>
</div>
<div id="hiding-intersection-size" class="section level3">
<h3 class="hasAnchor">
<a href="#hiding-intersection-size" class="anchor"></a>3.5 Hiding intersection size</h3>
<p>You can always disable the intersection size altogether:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">1.6</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    base_annotations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_56_0.png"></p>
</div>
<div id="showing-intersection-sizeunion-size-ratio" class="section level3">
<h3 class="hasAnchor">
<a href="#showing-intersection-sizeunion-size-ratio" class="anchor"></a>3.6 Showing intersection size/union size ratio</h3>
<p>It can be useful to visualise which intersections are larger than expected by chance (assuming equal probability of belonging to multiple sets); this can be achieved using the intersection size/union size ratio.</p>
<blockquote>
<p>Note: this ratio cannot be computed for the null intersection (observations which do not belong to either of the groups), as denominator would be 0.</p>
</blockquote>
<blockquote>
<p>Important note: with early min/max trimming the intersection ratio uses the trimmed denominator. In most cases you probably want to set <code>min_max_early=FALSE</code> when plotting ratios with any kind of filtering imposed.</p>
</blockquote>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">6</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, min_size<span class="op">=</span><span class="fl">10</span>,
    base_annotations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Intersection size'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span><span class="op">(</span><span class="op">)</span>,
        <span class="st">'Intersection ratio'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_ratio.html">intersection_ratio</a></span><span class="op">(</span><span class="op">)</span>
    <span class="op">)</span>,
    min_max_early<span class="op">=</span><span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
<pre><code>Warning message:
“Removed 62 rows containing missing values (position_stack).”</code></pre>
<p><img src="Examples_R_files/Examples_R_59_1.png"></p>
<p>The plot above tells us that the analysed documentary movies are almost always (in over 60% of cases) documentaries (and nothing more!), while comedies more often include elements of other genres (e.g. drama, romance) rather than being comedies alone (like stand-up shows).</p>
</div>
<div id="showing-percentages" class="section level3">
<h3 class="hasAnchor">
<a href="#showing-percentages" class="anchor"></a>3.7 Showing percentages</h3>
<p><code>text_aes</code> can be used to manipulate the aesthetics of the labels. Using the <code>intersection_size</code> and <code>union_size</code> one can calculate percentage of items in the intersection (relative to the potential size of the intersection). A <code><a href="../reference/upset_text_percentage.html">upset_text_percentage(digits=0, sep='')</a></code> shorthand is provided for convenience; please note that it has to be used with <code>aes_</code> rather than <code>aes</code>:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">6</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, min_size<span class="op">=</span><span class="fl">10</span>,
    base_annotations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="co"># with manual aes specification:</span>
        <span class="st">'Intersection size'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span><span class="op">(</span>text_aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">intersection_size</span><span class="op">/</span><span class="va">union_size</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span>, <span class="st">'%'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
        <span class="co"># using shorthand:</span>
        <span class="st">'Intersection ratio'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_ratio.html">intersection_ratio</a></span><span class="op">(</span>text_aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html">aes_</a></span><span class="op">(</span>label<span class="op">=</span><span class="fu"><a href="../reference/upset_text_percentage.html">upset_text_percentage</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>,
    min_max_early<span class="op">=</span><span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
<pre><code>Warning message:
“Removed 62 rows containing missing values (position_stack).”</code></pre>
<p><img src="Examples_R_files/Examples_R_63_1.png"></p>
<p>Also see <a href="#10-display-percentages">10. Display percentages</a>.</p>
</div>
<div id="further-adjustments-using-ggplot2-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#further-adjustments-using-ggplot2-functions" class="anchor"></a>3.8 Further adjustments using ggplot2 functions</h3>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>,
    base_annotations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Intersection size'</span><span class="op">=</span><span class="op">(</span>
            <span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span><span class="op">(</span><span class="op">)</span>
            <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">700</span><span class="op">)</span><span class="op">)</span>
            <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.background<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill<span class="op">=</span><span class="st">'#E5D3B3'</span><span class="op">)</span><span class="op">)</span>
            <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">'# observations in intersection'</span><span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>,
    min_size<span class="op">=</span><span class="fl">10</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_66_0.png"></p>
</div>
</div>
<div id="adjusting-set-size" class="section level2">
<h2 class="hasAnchor">
<a href="#adjusting-set-size" class="anchor"></a>4. Adjusting “set size”</h2>
<div id="rotate-labels" class="section level3">
<h3 class="hasAnchor">
<a href="#rotate-labels" class="anchor"></a>4.1 Rotate labels</h3>
<p>To rotate the labels modify corresponding theme:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">4</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>,
    min_size<span class="op">=</span><span class="fl">100</span>,
    width_ratio<span class="op">=</span><span class="fl">0.15</span>,
    themes<span class="op">=</span><span class="fu"><a href="../reference/upset_modify_themes.html">upset_modify_themes</a></span><span class="op">(</span>
        <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            <span class="st">'overall_sizes'</span><span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle<span class="op">=</span><span class="fl">90</span><span class="op">)</span><span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_70_0.png"></p>
<p>To display the ticks:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">4</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, width_ratio<span class="op">=</span><span class="fl">0.3</span>, min_size<span class="op">=</span><span class="fl">100</span>, wrap<span class="op">=</span><span class="cn">TRUE</span>,
    themes<span class="op">=</span><span class="fu"><a href="../reference/upset_modify_themes.html">upset_modify_themes</a></span><span class="op">(</span>
        <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            <span class="st">'overall_sizes'</span><span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.ticks.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_72_0.png"></p>
</div>
<div id="modify-geoms-and-other-layers" class="section level3">
<h3 class="hasAnchor">
<a href="#modify-geoms-and-other-layers" class="anchor"></a>4.2 Modify geoms and other layers</h3>
<p>Arguments of the <code>geom_bar</code> can be passed to <code>upset_set_size</code>; it can even use a different geom, or be replaced with a custom list of layers altogether:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>

<span class="op">(</span>
    <span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
        <span class="va">movies</span>, <span class="va">genres</span>, width_ratio<span class="op">=</span><span class="fl">0.5</span>, max_size<span class="op">=</span><span class="fl">100</span>, min_size<span class="op">=</span><span class="fl">15</span>, wrap<span class="op">=</span><span class="cn">TRUE</span>,
        set_sizes<span class="op">=</span><span class="fu"><a href="../reference/upset_set_size.html">upset_set_size</a></span><span class="op">(</span>
            width<span class="op">=</span><span class="fl">0.4</span>
        <span class="op">)</span>
    <span class="op">)</span>
    <span class="op">+</span>
    <span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
        <span class="va">movies</span>, <span class="va">genres</span>, width_ratio<span class="op">=</span><span class="fl">0.5</span>, max_size<span class="op">=</span><span class="fl">100</span>, min_size<span class="op">=</span><span class="fl">15</span>, wrap<span class="op">=</span><span class="cn">TRUE</span>,
        set_sizes<span class="op">=</span><span class="fu"><a href="../reference/upset_set_size.html">upset_set_size</a></span><span class="op">(</span>
            geom<span class="op">=</span><span class="va">geom_point</span>,
            stat<span class="op">=</span><span class="st">'count'</span>,
            color<span class="op">=</span><span class="st">'blue'</span>
        <span class="op">)</span>
    <span class="op">)</span>
    <span class="op">+</span>
    <span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
        <span class="va">movies</span>, <span class="va">genres</span>, width_ratio<span class="op">=</span><span class="fl">0.5</span>, max_size<span class="op">=</span><span class="fl">100</span>, min_size<span class="op">=</span><span class="fl">15</span>, wrap<span class="op">=</span><span class="cn">TRUE</span>,
        set_sizes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">..count..</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span>, stat<span class="op">=</span><span class="st">'count'</span><span class="op">)</span>,
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">'Size relative to the largest'</span><span class="op">)</span>,
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_reverse</a></span><span class="op">(</span><span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_75_0.png"></p>
</div>
<div id="logarithmic-scale" class="section level3">
<h3 class="hasAnchor">
<a href="#logarithmic-scale" class="anchor"></a>4.3 Logarithmic scale</h3>
<p>In order to use a log scale we need pass additional scale to in <code>layers</code> argument. However, as the bars are on flipped coordinates, we need a reversed log transformation:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">preserve_infinite</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">f</span><span class="op">)</span> <span class="op">{</span>
    <span class="co"># this allows the stripes (which span from -Inf to +Inf) to be displayed</span>
    <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
        <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="cn">Inf</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
            <span class="va">x</span>
        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
            <span class="fu">f</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
        <span class="op">}</span>
    <span class="op">}</span>
<span class="op">}</span>

<span class="va">reverse_log_trans</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">base</span><span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="op">{</span>
    <span class="co"># CC-BY-SA 4.0 Brian Diggs, modified</span>
    <span class="co"># https://stackoverflow.com/a/11054781</span>
    <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/trans_new.html">trans_new</a></span><span class="op">(</span>
        <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span>
            <span class="st">'reverselog-'</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">base</span><span class="op">)</span><span class="op">)</span>,
            <span class="fu">preserve_infinite</span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">base</span><span class="op">)</span><span class="op">)</span>,
            <span class="fu">preserve_infinite</span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">base</span><span class="op">^</span><span class="op">-</span><span class="va">x</span><span class="op">)</span>,
            <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/breaks_log.html">log_breaks</a></span><span class="op">(</span>base<span class="op">=</span><span class="va">base</span><span class="op">)</span>,
            domain <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1e-100</span>, <span class="cn">Inf</span><span class="op">)</span>
    <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Which is then easy to apply:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    set_sizes<span class="op">=</span><span class="fu"><a href="../reference/upset_set_size.html">upset_set_size</a></span><span class="op">(</span>
        width<span class="op">=</span><span class="fl">0.4</span>,
        layers<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>trans<span class="op">=</span><span class="fu">reverse_log_trans</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>,
    themes<span class="op">=</span><span class="fu"><a href="../reference/upset_modify_themes.html">upset_modify_themes</a></span><span class="op">(</span>
        <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">'overall_sizes'</span><span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle<span class="op">=</span><span class="fl">90</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>,
    queries<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/upset_query.html">upset_query</a></span><span class="op">(</span>set<span class="op">=</span><span class="st">'Drama'</span>, fill<span class="op">=</span><span class="st">'blue'</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_80_0.png"></p>
<p>We can also modify the labels to display the logged values:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.2</span>,
    set_sizes<span class="op">=</span><span class="fu"><a href="../reference/upset_set_size.html">upset_set_size</a></span><span class="op">(</span>
        width<span class="op">=</span><span class="fl">0.4</span>,
        layers<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>
                trans<span class="op">=</span><span class="fu">reverse_log_trans</span><span class="op">(</span><span class="op">)</span>,
                labels<span class="op">=</span><span class="va">log10</span>
            <span class="op">)</span>,
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">'log10(set size)'</span><span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_82_0.png"></p>
</div>
<div id="hide-the-set-sizes-altogether" class="section level3">
<h3 class="hasAnchor">
<a href="#hide-the-set-sizes-altogether" class="anchor"></a>4.4 Hide the set sizes altogether</h3>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    set_sizes<span class="op">=</span><span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_84_0.png"></p>
</div>
</div>
<div id="adjusting-other-aesthetics" class="section level2">
<h2 class="hasAnchor">
<a href="#adjusting-other-aesthetics" class="anchor"></a>5. Adjusting other aesthetics</h2>
<div id="stripes" class="section level3">
<h3 class="hasAnchor">
<a href="#stripes" class="anchor"></a>5.1 Stripes</h3>
<p>Change the colors:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">6</span>, <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.2</span>,
    stripes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'cornsilk1'</span>, <span class="st">'deepskyblue1'</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_88_0.png"></p>
<p>You can use multiple colors:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">6</span>, <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.2</span>,
    stripes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'cornsilk1'</span>, <span class="st">'deepskyblue1'</span>, <span class="st">'grey90'</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_90_0.png"></p>
<p>Or, set the color to white to effectively disable the stripes:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">6</span>, <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.2</span>,
    stripes<span class="op">=</span><span class="st">'white'</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_92_0.png"></p>
</div>
<div id="adding-title" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-title" class="anchor"></a>5.2 Adding title</h3>
<p>Adding title with <code>ggtitle</code> with add it to the intersection matrix:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">6</span>, <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, min_size<span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">'Intersection matrix title'</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_95_0.png"></p>
<p>In order to add a title for the entire plot, you need to wrap the plot:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">6</span>, <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, min_size<span class="op">=</span><span class="fl">10</span>, wrap<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">'The overlap between genres'</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_97_0.png"></p>
</div>
<div id="making-the-plot-transparent" class="section level3">
<h3 class="hasAnchor">
<a href="#making-the-plot-transparent" class="anchor"></a>5.3 Making the plot transparent</h3>
<p>You need to set the plot background to transparent and adjust colors of stripes to your liking:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">6</span>, <span class="fl">4</span><span class="op">)</span>
<span class="op">(</span>
    <span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
        <span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, min_size<span class="op">=</span><span class="fl">10</span>,
        stripes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://scales.r-lib.org//reference/alpha.html">alpha</a></span><span class="op">(</span><span class="st">'grey90'</span>, <span class="fl">0.45</span><span class="op">)</span>, <span class="fu"><a href="https://scales.r-lib.org//reference/alpha.html">alpha</a></span><span class="op">(</span><span class="st">'white'</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>
    <span class="op">&amp;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.background<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill<span class="op">=</span><span class="st">'transparent'</span>, color<span class="op">=</span><span class="cn">NA</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_100_0.png"></p>
<p>Use <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave('upset.png', bg="transparent")</a></code> when exporting to PNG.</p>
</div>
</div>
<div id="themes" class="section level2">
<h2 class="hasAnchor">
<a href="#themes" class="anchor"></a>6. Themes</h2>
<p>The themes for specific components are defined in <code>upset_themes</code> list, which contains themes for:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">upset_themes</span><span class="op">)</span></code></pre></div>
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline">
<li>
‘intersections_matrix’
</li>
<li>
‘Intersection size’
</li>
<li>
‘overall_sizes’
</li>
<li>
‘default’
</li>
</ol>
<p>You can substitute this list for your own using <code>themes</code> argument. While you can specify a theme for every component, if you omit one or more components those will be taken from the element named <code>default</code>.</p>
<div id="substituting-themes" class="section level3">
<h3 class="hasAnchor">
<a href="#substituting-themes" class="anchor"></a>6.1 Substituting themes</h3>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, min_size<span class="op">=</span><span class="fl">10</span>, themes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>default<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_107_0.png"></p>
<p>You can also add themes for your custom panels/annotations:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">8</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>,
    <span class="va">genres</span>,
    annotations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Length'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">intersection</span>, y<span class="op">=</span><span class="va">length</span><span class="op">)</span>,
            geom<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span>
        <span class="op">)</span>,
        <span class="st">'Rating'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">intersection</span>, y<span class="op">=</span><span class="va">rating</span><span class="op">)</span>,
            geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">votes</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>
            <span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>,
    min_size<span class="op">=</span><span class="fl">10</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>,
    themes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/utils/modifyList.html">modifyList</a></span><span class="op">(</span>
        <span class="va">upset_themes</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Rating<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span>, Length<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_109_0.png"></p>
</div>
<div id="adjusting-the-default-themes" class="section level3">
<h3 class="hasAnchor">
<a href="#adjusting-the-default-themes" class="anchor"></a>6.2 Adjusting the default themes</h3>
<p>Modify all the default themes as once with <code><a href="../reference/upset_default_themes.html">upset_default_themes()</a></code>:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">4</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, min_size<span class="op">=</span><span class="fl">10</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>,
    themes<span class="op">=</span><span class="fu"><a href="../reference/upset_default_themes.html">upset_default_themes</a></span><span class="op">(</span>text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">'red'</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_112_0.png"></p>
<p>To modify only a subset of default themes use <code><a href="../reference/upset_modify_themes.html">upset_modify_themes()</a></code>:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">4</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>,
    base_annotations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">'Intersection size'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span><span class="op">(</span>counts<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>,
    min_size<span class="op">=</span><span class="fl">100</span>,
    width_ratio<span class="op">=</span><span class="fl">0.1</span>,
    themes<span class="op">=</span><span class="fu"><a href="../reference/upset_modify_themes.html">upset_modify_themes</a></span><span class="op">(</span>
        <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            <span class="st">'intersections_matrix'</span><span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span>,
            <span class="st">'overall_sizes'</span><span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle<span class="op">=</span><span class="fl">90</span><span class="op">)</span><span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_114_0.png"></p>
</div>
</div>
<div id="highlighting-queries" class="section level2">
<h2 class="hasAnchor">
<a href="#highlighting-queries" class="anchor"></a>7. Highlighting (queries)</h2>
<p>Pass a list of lists generated with <code><a href="../reference/upset_query.html">upset_query()</a></code> utility to the optional <code>queries</code> argument to selectively modify aesthetics of specific intersections or sets.</p>
<p>Use one of the arguments: <code>set</code> or <code>intersection</code> (not both) to specify what to highlight: - <code>set</code> will highlight the bar of the set size, - <code>intersection</code> will highlight an intersection on all components (by default), or on components chosen with <code>only_components</code> - all other parameters will be used to modify the geoms</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">6</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, min_size<span class="op">=</span><span class="fl">10</span>,
    annotations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Length'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">intersection</span>, y<span class="op">=</span><span class="va">length</span><span class="op">)</span>,
            geom<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>,
    queries<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="fu"><a href="../reference/upset_query.html">upset_query</a></span><span class="op">(</span>
            intersect<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Drama'</span>, <span class="st">'Comedy'</span><span class="op">)</span>,
            color<span class="op">=</span><span class="st">'red'</span>,
            fill<span class="op">=</span><span class="st">'red'</span>,
            only_components<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'intersections_matrix'</span>, <span class="st">'Intersection size'</span><span class="op">)</span>
        <span class="op">)</span>,
        <span class="fu"><a href="../reference/upset_query.html">upset_query</a></span><span class="op">(</span>
            set<span class="op">=</span><span class="st">'Drama'</span>,
            fill<span class="op">=</span><span class="st">'blue'</span>
        <span class="op">)</span>,
        <span class="fu"><a href="../reference/upset_query.html">upset_query</a></span><span class="op">(</span>
            intersect<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Romance'</span>, <span class="st">'Comedy'</span><span class="op">)</span>,
            fill<span class="op">=</span><span class="st">'yellow'</span>,
            only_components<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Length'</span><span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_117_0.png"></p>
</div>
<div id="sorting" class="section level2">
<h2 class="hasAnchor">
<a href="#sorting" class="anchor"></a>8. Sorting</h2>
<div id="sorting-intersections" class="section level3">
<h3 class="hasAnchor">
<a href="#sorting-intersections" class="anchor"></a>8.1 Sorting intersections</h3>
<p>By degree:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, sort_intersections_by<span class="op">=</span><span class="st">'degree'</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_121_0.png"></p>
<p>By ratio:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, min_size<span class="op">=</span><span class="fl">10</span>,
    sort_intersections_by<span class="op">=</span><span class="st">'ratio'</span>,
    base_annotations<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'Intersection size'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span><span class="op">(</span>text_aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html">aes_</a></span><span class="op">(</span>label<span class="op">=</span><span class="fu"><a href="../reference/upset_text_percentage.html">upset_text_percentage</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
        <span class="st">'Intersection ratio'</span><span class="op">=</span><span class="fu"><a href="../reference/intersection_ratio.html">intersection_ratio</a></span><span class="op">(</span>text_aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html">aes_</a></span><span class="op">(</span>label<span class="op">=</span><span class="fu"><a href="../reference/upset_text_percentage.html">upset_text_percentage</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_123_0.png"></p>
<p>The other way around:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, sort_intersections<span class="op">=</span><span class="st">'ascending'</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_125_0.png"></p>
<p>Without any sorting:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, sort_intersections<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_127_0.png"></p>
</div>
<div id="sorting-sets" class="section level3">
<h3 class="hasAnchor">
<a href="#sorting-sets" class="anchor"></a>8.2 Sorting sets</h3>
<p>Ascending:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, sort_sets<span class="op">=</span><span class="st">'ascending'</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_130_0.png"></p>
<p>Without sorting - preserving the order as in genres:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genres</span></code></pre></div>
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline">
<li>
‘Action’
</li>
<li>
‘Animation’
</li>
<li>
‘Comedy’
</li>
<li>
‘Drama’
</li>
<li>
‘Documentary’
</li>
<li>
‘Romance’
</li>
<li>
‘Short’
</li>
</ol>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">movies</span>, <span class="va">genres</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, sort_sets<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_133_0.png"></p>
</div>
</div>
<div id="grouping" class="section level2">
<h2 class="hasAnchor">
<a href="#grouping" class="anchor"></a>9. Grouping</h2>
<div id="grouping-intersections" class="section level3">
<h3 class="hasAnchor">
<a href="#grouping-intersections" class="anchor"></a>9.1 Grouping intersections</h3>
<p>Use <code>group_by='sets'</code> to group intersections by set. If needed, the intersections will be repeated so that they appear in each set group. Use <code><a href="../reference/upset_query.html">upset_query()</a></code> with <code>group</code> argument to color the intersection matrix accordingly.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Action"</span>, <span class="st">"Comedy"</span>, <span class="st">"Drama"</span><span class="op">)</span>,
    width_ratio<span class="op">=</span><span class="fl">0.2</span>,
    group_by<span class="op">=</span><span class="st">'sets'</span>,
    queries<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="fu"><a href="../reference/upset_query.html">upset_query</a></span><span class="op">(</span>
            intersect<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Drama'</span>, <span class="st">'Comedy'</span><span class="op">)</span>,
            color<span class="op">=</span><span class="st">'red'</span>,
            fill<span class="op">=</span><span class="st">'red'</span>,
            only_components<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'intersections_matrix'</span>, <span class="st">'Intersection size'</span><span class="op">)</span>
        <span class="op">)</span>,
        <span class="fu"><a href="../reference/upset_query.html">upset_query</a></span><span class="op">(</span>group<span class="op">=</span><span class="st">'Drama'</span>, color<span class="op">=</span><span class="st">'blue'</span><span class="op">)</span>,
        <span class="fu"><a href="../reference/upset_query.html">upset_query</a></span><span class="op">(</span>group<span class="op">=</span><span class="st">'Comedy'</span>, color<span class="op">=</span><span class="st">'orange'</span><span class="op">)</span>,
        <span class="fu"><a href="../reference/upset_query.html">upset_query</a></span><span class="op">(</span>group<span class="op">=</span><span class="st">'Action'</span>, color<span class="op">=</span><span class="st">'purple'</span><span class="op">)</span>,
        <span class="fu"><a href="../reference/upset_query.html">upset_query</a></span><span class="op">(</span>set<span class="op">=</span><span class="st">'Drama'</span>, fill<span class="op">=</span><span class="st">'blue'</span><span class="op">)</span>,
        <span class="fu"><a href="../reference/upset_query.html">upset_query</a></span><span class="op">(</span>set<span class="op">=</span><span class="st">'Comedy'</span>, fill<span class="op">=</span><span class="st">'orange'</span><span class="op">)</span>,
        <span class="fu"><a href="../reference/upset_query.html">upset_query</a></span><span class="op">(</span>set<span class="op">=</span><span class="st">'Action'</span>, fill<span class="op">=</span><span class="st">'purple'</span><span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_137_0.png"></p>
</div>
</div>
<div id="display-percentages" class="section level2">
<h2 class="hasAnchor">
<a href="#display-percentages" class="anchor"></a>10. Display percentages</h2>
<p>Use <code><a href="../reference/aes_percentage.html">aes_percentage()</a></code> utility preceeded with <code>!!</code> syntax to easily display percentages. In the examples below only percentages for the movies with R raiting are shown to avoid visual clutter.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">raiting_scale</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="st">'R'</span><span class="op">=</span><span class="st">'#E41A1C'</span>, <span class="st">'PG'</span><span class="op">=</span><span class="st">'#377EB8'</span>,
    <span class="st">'PG-13'</span><span class="op">=</span><span class="st">'#4DAF4A'</span>, <span class="st">'NC-17'</span><span class="op">=</span><span class="st">'#FF7F00'</span>
<span class="op">)</span><span class="op">)</span>
<span class="va">show_hide_scale</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'show'</span><span class="op">=</span><span class="st">'black'</span>, <span class="st">'hide'</span><span class="op">=</span><span class="st">'transparent'</span><span class="op">)</span>, guide<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div id="within-intersection" class="section level3">
<h3 class="hasAnchor">
<a href="#within-intersection" class="anchor"></a>10.1 Within intersection</h3>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">5</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, min_size<span class="op">=</span><span class="fl">100</span>,
    annotations <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'MPAA Raiting'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">intersection</span>, fill<span class="op">=</span><span class="va">mpaa</span><span class="op">)</span>,
            geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">'count'</span>, position<span class="op">=</span><span class="st">'fill'</span><span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>
                    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
                        label<span class="op">=</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="../reference/aes_percentage.html">aes_percentage</a></span><span class="op">(</span>relative_to<span class="op">=</span><span class="st">'intersection'</span><span class="op">)</span>,
                        color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">mpaa</span> <span class="op">==</span> <span class="st">'R'</span>, <span class="st">'show'</span>, <span class="st">'hide'</span><span class="op">)</span>
                    <span class="op">)</span>,
                    stat<span class="op">=</span><span class="st">'count'</span>,
                    position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html">position_fill</a></span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>
                <span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,
                <span class="va">show_hide_scale</span>,
                <span class="va">raiting_scale</span>
            <span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_142_0.png"></p>
</div>
<div id="relative-to-the-group" class="section level3">
<h3 class="hasAnchor">
<a href="#relative-to-the-group" class="anchor"></a>10.2 Relative to the group</h3>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">5</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, min_size<span class="op">=</span><span class="fl">100</span>,
    annotations <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'MPAA Raiting'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">intersection</span>, fill<span class="op">=</span><span class="va">mpaa</span><span class="op">)</span>,
            geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">'count'</span>, position<span class="op">=</span><span class="st">'fill'</span><span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>
                    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
                        label<span class="op">=</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="../reference/aes_percentage.html">aes_percentage</a></span><span class="op">(</span>relative_to<span class="op">=</span><span class="st">'group'</span><span class="op">)</span>,
                        group<span class="op">=</span><span class="va">mpaa</span>,
                        color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">mpaa</span> <span class="op">==</span> <span class="st">'R'</span>, <span class="st">'show'</span>, <span class="st">'hide'</span><span class="op">)</span>
                    <span class="op">)</span>,
                    stat<span class="op">=</span><span class="st">'count'</span>,
                    position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html">position_fill</a></span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>
                <span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,
                <span class="va">show_hide_scale</span>,
                <span class="va">raiting_scale</span>
            <span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_144_0.png"></p>
</div>
<div id="relative-to-all-observed-values" class="section level3">
<h3 class="hasAnchor">
<a href="#relative-to-all-observed-values" class="anchor"></a>10.3 Relative to all observed values</h3>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">5</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, min_size<span class="op">=</span><span class="fl">100</span>,
    annotations <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'MPAA Raiting'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">intersection</span>, fill<span class="op">=</span><span class="va">mpaa</span><span class="op">)</span>,
            geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">'count'</span>, position<span class="op">=</span><span class="st">'fill'</span><span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>
                    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
                        label<span class="op">=</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="../reference/aes_percentage.html">aes_percentage</a></span><span class="op">(</span>relative_to<span class="op">=</span><span class="st">'all'</span><span class="op">)</span>,
                        color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">mpaa</span> <span class="op">==</span> <span class="st">'R'</span>, <span class="st">'show'</span>, <span class="st">'hide'</span><span class="op">)</span>
                    <span class="op">)</span>,
                    stat<span class="op">=</span><span class="st">'count'</span>,
                    position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html">position_fill</a></span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>
                <span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_percent.html">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,
                <span class="va">show_hide_scale</span>,
                <span class="va">raiting_scale</span>
            <span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_146_0.png"></p>
</div>
</div>
<div id="advanced-usage-examples" class="section level2">
<h2 class="hasAnchor">
<a href="#advanced-usage-examples" class="anchor"></a>11. Advanced usage examples</h2>
<div id="display-text-on-some-bars-only" class="section level3">
<h3 class="hasAnchor">
<a href="#display-text-on-some-bars-only" class="anchor"></a>11.1 Display text on some bars only</h3>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">5</span><span class="op">)</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span>
    <span class="va">movies</span>, <span class="va">genres</span>, name<span class="op">=</span><span class="st">'genre'</span>, width_ratio<span class="op">=</span><span class="fl">0.1</span>, min_size<span class="op">=</span><span class="fl">100</span>,
    annotations <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        <span class="st">'MPAA Raiting'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">intersection</span>, fill<span class="op">=</span><span class="va">mpaa</span><span class="op">)</span>,
            geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">'count'</span>, position<span class="op">=</span><span class="st">'fill'</span><span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>
                    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">mpaa</span> <span class="op">==</span> <span class="st">'R'</span>, <span class="st">'R'</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>,
                    stat<span class="op">=</span><span class="st">'count'</span>,
                    position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html">position_fill</a></span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>,
                    na.rm<span class="op">=</span><span class="cn">TRUE</span>
                <span class="op">)</span>,
                <span class="va">show_hide_scale</span>,
                <span class="va">raiting_scale</span>
            <span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_149_0.png"></p>
</div>
<div id="combine-multiple-plots-together" class="section level3">
<h3 class="hasAnchor">
<a href="#combine-multiple-plots-together" class="anchor"></a>11.2 Combine multiple plots together</h3>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">set_size</span><span class="op">(</span><span class="fl">8</span>, <span class="fl">5</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>

<span class="va">annotations</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="st">'MPAA Raiting'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        aes<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">intersection</span>, fill<span class="op">=</span><span class="va">mpaa</span><span class="op">)</span>,
        geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">'count'</span>, position<span class="op">=</span><span class="st">'fill'</span><span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>    <span class="co"># for replicable example only</span>

<span class="va">data_1</span> <span class="op">=</span> <span class="va">movies</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">movies</span><span class="op">)</span>, <span class="fl">100</span><span class="op">)</span>, <span class="op">]</span>
<span class="va">data_2</span> <span class="op">=</span> <span class="va">movies</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">movies</span><span class="op">)</span>, <span class="fl">100</span><span class="op">)</span>, <span class="op">]</span>

<span class="va">u1</span> <span class="op">=</span> <span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">data_1</span>, <span class="va">genres</span>, min_size<span class="op">=</span><span class="fl">5</span>, base_annotations<span class="op">=</span><span class="va">annotations</span><span class="op">)</span>
<span class="va">u2</span> <span class="op">=</span> <span class="fu"><a href="../reference/upset.html">upset</a></span><span class="op">(</span><span class="va">data_2</span>, <span class="va">genres</span>, min_size<span class="op">=</span><span class="fl">5</span>, base_annotations<span class="op">=</span><span class="va">annotations</span><span class="op">)</span>

<span class="op">(</span><span class="va">u1</span> <span class="op">|</span> <span class="va">u2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides<span class="op">=</span><span class="st">'collect'</span><span class="op">)</span></code></pre></div>
<p><img src="Examples_R_files/Examples_R_151_0.png"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Michał Krassowski.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
