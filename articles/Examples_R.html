<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Examples - R • ComplexUpset</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Examples - R">
<meta property="og:description" content="ComplexUpset">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@krassowski">
<meta name="twitter:site" content="@krassowski">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ComplexUpset</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Examples_Python.html">Examples - Python</a>
    </li>
    <li>
      <a href="../articles/Examples_R.html">Examples - R</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/krassowski/complex-upset/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Examples - R</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/krassowski/complex-upset/blob/master/vignettes/Examples_R.Rmd"><code>vignettes/Examples_R.Rmd</code></a></small>
      <div class="hidden name"><code>Examples_R.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ComplexUpset</span>)</pre></body></html></div>
<div id="prepare-the-datasets" class="section level2">
<h2 class="hasAnchor">
<a href="#prepare-the-datasets" class="anchor"></a>Prepare the datasets</h2>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">movies</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="kw pkg">ggplot2movies</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/ggplot2movies/man/movies.html">movies</a></span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">movies</span>, <span class="fl">3</span>)</pre></body></html></div>
<table class="table">
<caption>
A data.frame: 3 × 24
</caption>
<thead>
<tr>
<th>
</th>
<th scope="col">
title
</th>
<th scope="col">
year
</th>
<th scope="col">
length
</th>
<th scope="col">
budget
</th>
<th scope="col">
rating
</th>
<th scope="col">
votes
</th>
<th scope="col">
r1
</th>
<th scope="col">
r2
</th>
<th scope="col">
r3
</th>
<th scope="col">
r4
</th>
<th scope="col">
⋯
</th>
<th scope="col">
r9
</th>
<th scope="col">
r10
</th>
<th scope="col">
mpaa
</th>
<th scope="col">
Action
</th>
<th scope="col">
Animation
</th>
<th scope="col">
Comedy
</th>
<th scope="col">
Drama
</th>
<th scope="col">
Documentary
</th>
<th scope="col">
Romance
</th>
<th scope="col">
Short
</th>
</tr>
<tr>
<th>
</th>
<th scope="col">
&lt;chr&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
⋯
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;chr&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
</tr>
</thead>
<tbody>
<tr>
<th scope="row">
1
</th>
<td>
$
</td>
<td>
1971
</td>
<td>
121
</td>
<td>
NA
</td>
<td>
6.4
</td>
<td>
348
</td>
<td>
4.5
</td>
<td>
4.5
</td>
<td>
4.5
</td>
<td>
4.5
</td>
<td>
⋯
</td>
<td>
4.5
</td>
<td>
4.5
</td>
<td>
</td>
<td>
0
</td>
<td>
0
</td>
<td>
1
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
</tr>
<tr>
<th scope="row">
2
</th>
<td>
$1000 a Touchdown
</td>
<td>
1939
</td>
<td>
71
</td>
<td>
NA
</td>
<td>
6.0
</td>
<td>
20
</td>
<td>
0.0
</td>
<td>
14.5
</td>
<td>
4.5
</td>
<td>
24.5
</td>
<td>
⋯
</td>
<td>
4.5
</td>
<td>
14.5
</td>
<td>
</td>
<td>
0
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
</tr>
<tr>
<th scope="row">
3
</th>
<td>
$21 a Day Once a Month
</td>
<td>
1941
</td>
<td>
7
</td>
<td>
NA
</td>
<td>
8.2
</td>
<td>
5
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
⋯
</td>
<td>
24.5
</td>
<td>
24.5
</td>
<td>
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
1
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">genres</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">movies</span>)[<span class="fl">18</span>:<span class="fl">24</span>]
<span class="no">genres</span></pre></body></html></div>
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline">
<li>
‘Action’
</li>
<li>
‘Animation’
</li>
<li>
‘Comedy’
</li>
<li>
‘Drama’
</li>
<li>
‘Documentary’
</li>
<li>
‘Romance’
</li>
<li>
‘Short’
</li>
</ol>
<p>Convert the genre indicator columns to use boolean values:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">movies</span>[<span class="no">genres</span>] <span class="kw">=</span> <span class="no">movies</span>[<span class="no">genres</span>] <span class="kw">==</span> <span class="fl">1</span>
<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">movies</span>[<span class="no">genres</span>], <span class="fl">3</span>))</pre></body></html></div>
<table class="table">
<caption>
A matrix: 7 × 3 of type lgl
</caption>
<thead><tr>
<th>
</th>
<th scope="col">
1
</th>
<th scope="col">
2
</th>
<th scope="col">
3
</th>
</tr></thead>
<tbody>
<tr>
<th scope="row">
Action
</th>
<td>
FALSE
</td>
<td>
FALSE
</td>
<td>
FALSE
</td>
</tr>
<tr>
<th scope="row">
Animation
</th>
<td>
FALSE
</td>
<td>
FALSE
</td>
<td>
TRUE
</td>
</tr>
<tr>
<th scope="row">
Comedy
</th>
<td>
TRUE
</td>
<td>
TRUE
</td>
<td>
FALSE
</td>
</tr>
<tr>
<th scope="row">
Drama
</th>
<td>
TRUE
</td>
<td>
FALSE
</td>
<td>
FALSE
</td>
</tr>
<tr>
<th scope="row">
Documentary
</th>
<td>
FALSE
</td>
<td>
FALSE
</td>
<td>
FALSE
</td>
</tr>
<tr>
<th scope="row">
Romance
</th>
<td>
FALSE
</td>
<td>
FALSE
</td>
<td>
FALSE
</td>
</tr>
<tr>
<th scope="row">
Short
</th>
<td>
FALSE
</td>
<td>
FALSE
</td>
<td>
TRUE
</td>
</tr>
</tbody>
</table>
<p>To keep the examples fast to complie we will operate on a subset of the movies with complete data:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">movies</span>[<span class="no">movies</span>$<span class="no">mpaa</span> <span class="kw">==</span> <span class="st">''</span>, <span class="st">'mpaa'</span>] <span class="kw">=</span> <span class="fl">NA</span>
<span class="no">movies</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span>(<span class="no">movies</span>)</pre></body></html></div>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="co"># utility for changing output parameters in Jupyter notebooks - please ignore!</span>
<span class="no">set_size</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">w</span>, <span class="no">h</span>, <span class="no">s</span><span class="kw">=</span><span class="fl">1.5</span>) { <span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="kw">repr.plot.width</span><span class="kw">=</span><span class="no">w</span>*<span class="no">s</span>, <span class="kw">repr.plot.height</span><span class="kw">=</span><span class="no">h</span>*<span class="no">s</span>, <span class="kw">repr.plot.res</span><span class="kw">=</span><span class="fl">150</span>, <span class="kw">jupyter.plot_mimetypes</span><span class="kw">=</span><span class="st">'image/png'</span>) }</pre></body></html></div>
</div>
<div id="basic-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-usage" class="anchor"></a>0. Basic usage</h2>
<p>There are two required arguments: - the first argument is expected to be a dataframe with both group indicator variables and covariates, - the second argument specifies a list with names of column which indicate the group membership.</p>
<p>Additional arguments can be provided, such as <code>name</code> (specifies xlab for intersection matrix) or <code>width_ratio</code> (specifies how much space should be occupied by the set size panel). Other such arguments are discussed at length later in this document.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">3</span>)
<span class="fu"><a href="../reference/upset.html">upset</a></span>(<span class="no">movies</span>, <span class="no">genres</span>, <span class="kw">name</span><span class="kw">=</span><span class="st">'genre'</span>, <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.1</span>)</pre></body></html></div>
<p><img src="Examples_R_files/Examples_R_11_0.png"></p>
<div id="selecting-intersections-by-size" class="section level3">
<h3 class="hasAnchor">
<a href="#selecting-intersections-by-size" class="anchor"></a>0.1 Selecting intersections by size</h3>
<p>We will focus on the intersections with at least ten members <code>(min_size=10)</code> and on a few variables which are significantly different between the intersections (see 2. Running statistical tests).</p>
<p>When using <code>min_size</code>, the empty groups will be skipped by default (e.g. <em>Short</em> movies would have no overlap with size of 10). To keep all groups pass <code>keep_empty_groups=TRUE</code>:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">3</span>)
(
    <span class="fu"><a href="../reference/upset.html">upset</a></span>(<span class="no">movies</span>, <span class="no">genres</span>, <span class="kw">name</span><span class="kw">=</span><span class="st">'genre'</span>, <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.1</span>, <span class="kw">min_size</span><span class="kw">=</span><span class="fl">10</span>, <span class="kw">wrap</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="kw">set_sizes</span><span class="kw">=</span><span class="fl">FALSE</span>)
    + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">'Without empty groups (Short dropped)'</span>)
    +    <span class="co"># adding plots is possible thanks to patchwork</span>
    <span class="fu"><a href="../reference/upset.html">upset</a></span>(<span class="no">movies</span>, <span class="no">genres</span>, <span class="kw">name</span><span class="kw">=</span><span class="st">'genre'</span>, <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.1</span>, <span class="kw">min_size</span><span class="kw">=</span><span class="fl">10</span>, <span class="kw">keep_empty_groups</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="kw">wrap</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="kw">set_sizes</span><span class="kw">=</span><span class="fl">FALSE</span>)
    + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">'With empty groups'</span>)
)</pre></body></html></div>
<pre><code>[1] "Dropping empty groups: Short"</code></pre>
<p><img src="Examples_R_files/Examples_R_14_1.png"></p>
<p>When empty columns are detected a warning will be issued. The silence it, pass <code>warn_when_dropping_groups=FALSE</code>.</p>
</div>
</div>
<div id="adding-components" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-components" class="anchor"></a>1. Adding components</h2>
<p>We can add multiple annotation components (also called panels):</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">8</span>)

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">0</span>)   <span class="co"># keep the same jitter for identical plots</span>

<span class="fu"><a href="../reference/upset.html">upset</a></span>(
    <span class="no">movies</span>,
    <span class="no">genres</span>,
    <span class="kw">annotations</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
        <span class="st">'Length'</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
            <span class="kw">aes</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">intersection</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">length</span>),
            <span class="kw">geom</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span>()
        ),
        <span class="st">'Rating'</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
            <span class="kw">aes</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">intersection</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">rating</span>),
            <span class="kw">geom</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
                <span class="co"># checkout ggbeeswarm::geom_quasirandom for better results!</span>
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">color</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(<span class="no">votes</span>))),
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span>(<span class="kw">width</span><span class="kw">=</span><span class="fl">1.1</span>, <span class="kw">alpha</span><span class="kw">=</span><span class="fl">0.5</span>)
            )
        ),
        <span class="st">'Budget'</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
            <span class="kw">aes</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">intersection</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">budget</span>),
            <span class="kw">geom</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span>()
        )
    ),
    <span class="kw">min_size</span><span class="kw">=</span><span class="fl">10</span>,
    <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.1</span>
)</pre></body></html></div>
<pre><code>[1] "Dropping empty groups: Short"


Warning message:
“position_dodge requires non-overlapping x intervals”</code></pre>
<p><img src="Examples_R_files/Examples_R_18_2.png"></p>
<p>For simple annotations, such as the length above, you can use a shorthand notation of <code>upset_annotate</code>:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">6</span>)

<span class="fu"><a href="../reference/upset.html">upset</a></span>(
    <span class="no">movies</span>,
    <span class="no">genres</span>,
    <span class="kw">annotations</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
        <span class="st">'Length'</span><span class="kw">=</span><span class="fu"><a href="../reference/upset_annotate.html">upset_annotate</a></span>(<span class="st">'length'</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span>()),
        <span class="st">'Budget'</span><span class="kw">=</span><span class="fu"><a href="../reference/upset_annotate.html">upset_annotate</a></span>(<span class="st">'budget'</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span>())
    ),
    <span class="kw">min_size</span><span class="kw">=</span><span class="fl">10</span>,
    <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.1</span>
)</pre></body></html></div>
<pre><code>[1] "Dropping empty groups: Short"</code></pre>
<p><img src="Examples_R_files/Examples_R_20_1.png"></p>
<p>You can also barplots to demonstrate difference in proportions of categorical variables:</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">5</span>)

<span class="fu"><a href="../reference/upset.html">upset</a></span>(
    <span class="no">movies</span>,
    <span class="no">genres</span>,
    <span class="kw">annotations</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
        <span class="st">'MPAA Raiting'</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
            <span class="kw">aes</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">intersection</span>, <span class="kw">fill</span><span class="kw">=</span><span class="no">mpaa</span>),
            <span class="kw">geom</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span>(<span class="kw">stat</span><span class="kw">=</span><span class="st">'count'</span>, <span class="kw">position</span><span class="kw">=</span><span class="st">'fill'</span>),
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="kw">labels</span><span class="kw">=</span><span class="kw pkg">scales</span><span class="kw ns">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_percent.html">percent_format</a></span>()),
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span>(<span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
                    <span class="st">'R'</span><span class="kw">=</span><span class="st">'#E41A1C'</span>, <span class="st">'PG'</span><span class="kw">=</span><span class="st">'#377EB8'</span>,
                    <span class="st">'PG-13'</span><span class="kw">=</span><span class="st">'#4DAF4A'</span>, <span class="st">'NC-17'</span><span class="kw">=</span><span class="st">'#FF7F00'</span>
                ))
            )
        )
    ),
    <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.1</span>
)</pre></body></html></div>
<p><img src="Examples_R_files/Examples_R_22_0.png"></p>
</div>
<div id="running-statistical-tests" class="section level2">
<h2 class="hasAnchor">
<a href="#running-statistical-tests" class="anchor"></a>2. Running statistical tests</h2>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="../reference/upset_test.html">upset_test</a></span>(<span class="no">movies</span>, <span class="no">genres</span>)</pre></body></html></div>
<pre><code>[1] "year, length, budget, rating, votes, r1, r2, r3, r4, r5, r6, r7, r8, r9, r10, mpaa differ significantly between intersections"</code></pre>
<table class="table">
<caption>
A data.frame: 17 × 5
</caption>
<thead>
<tr>
<th>
</th>
<th scope="col">
variable
</th>
<th scope="col">
p.value
</th>
<th scope="col">
statistic
</th>
<th scope="col">
test
</th>
<th scope="col">
fdr
</th>
</tr>
<tr>
<th>
</th>
<th scope="col">
&lt;fct&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;fct&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
</tr>
</thead>
<tbody>
<tr>
<th scope="row">
length
</th>
<td>
length
</td>
<td>
6.511525e-71
</td>
<td>
422.88444
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.106959e-69
</td>
</tr>
<tr>
<th scope="row">
rating
</th>
<td>
rating
</td>
<td>
1.209027e-46
</td>
<td>
301.72764
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.027673e-45
</td>
</tr>
<tr>
<th scope="row">
budget
</th>
<td>
budget
</td>
<td>
3.899860e-44
</td>
<td>
288.97476
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
2.209921e-43
</td>
</tr>
<tr>
<th scope="row">
r8
</th>
<td>
r8
</td>
<td>
9.900004e-39
</td>
<td>
261.28815
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
4.207502e-38
</td>
</tr>
<tr>
<th scope="row">
mpaa
</th>
<td>
mpaa
</td>
<td>
3.732200e-35
</td>
<td>
242.77939
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.268948e-34
</td>
</tr>
<tr>
<th scope="row">
r9
</th>
<td>
r9
</td>
<td>
1.433256e-30
</td>
<td>
218.78160
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
4.060891e-30
</td>
</tr>
<tr>
<th scope="row">
r1
</th>
<td>
r1
</td>
<td>
2.211600e-23
</td>
<td>
180.32740
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
5.371029e-23
</td>
</tr>
<tr>
<th scope="row">
r4
</th>
<td>
r4
</td>
<td>
1.008119e-18
</td>
<td>
154.62772
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
2.142254e-18
</td>
</tr>
<tr>
<th scope="row">
r3
</th>
<td>
r3
</td>
<td>
2.568227e-17
</td>
<td>
146.70217
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
4.851095e-17
</td>
</tr>
<tr>
<th scope="row">
r5
</th>
<td>
r5
</td>
<td>
9.823827e-16
</td>
<td>
137.66310
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.670051e-15
</td>
</tr>
<tr>
<th scope="row">
r7
</th>
<td>
r7
</td>
<td>
9.201549e-14
</td>
<td>
126.19243
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.422058e-13
</td>
</tr>
<tr>
<th scope="row">
r2
</th>
<td>
r2
</td>
<td>
2.159955e-13
</td>
<td>
124.00604
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
3.059936e-13
</td>
</tr>
<tr>
<th scope="row">
r10
</th>
<td>
r10
</td>
<td>
1.283470e-11
</td>
<td>
113.38113
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.678384e-11
</td>
</tr>
<tr>
<th scope="row">
votes
</th>
<td>
votes
</td>
<td>
2.209085e-10
</td>
<td>
105.79588
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
2.682460e-10
</td>
</tr>
<tr>
<th scope="row">
r6
</th>
<td>
r6
</td>
<td>
3.779129e-05
</td>
<td>
70.80971
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
4.283013e-05
</td>
</tr>
<tr>
<th scope="row">
year
</th>
<td>
year
</td>
<td>
2.745818e-02
</td>
<td>
46.55972
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
2.917431e-02
</td>
</tr>
<tr>
<th scope="row">
title
</th>
<td>
title
</td>
<td>
2.600003e-01
</td>
<td>
34.53375
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
2.600003e-01
</td>
</tr>
</tbody>
</table>
<p><code>Kruskal-Wallis rank sum test</code> is not always the best choice.</p>
<p>You can either change the test for:</p>
<ul>
<li>all the variables (<code>test=your.test</code>), or</li>
<li>specific variables (using <code>tests=list(variable=some.test)</code> argument)</li>
</ul>
<p>The tests are called with <code>(formula=variable ~ intersection, data)</code> signature, such as accepted by <code>kruskal.test</code>. The result is expected to be a list with following members:</p>
<ul>
<li><code>p.value</code></li>
<li><code>statistic</code></li>
<li><code>method</code></li>
</ul>
<p>It is easy to adapt tests which do not obey this signature/output convention; for example the Chi-squared test and anova can be wrapped with two-line functions as follows:</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">chisq_from_formula</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">formula</span>, <span class="no">data</span>) {
    <span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span>(
        <span class="fu"><a href="https://rdrr.io/r/stats/ftable.html">ftable</a></span>(<span class="no">formula</span>, <span class="no">data</span>)
    )
}

<span class="no">anova_single</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">formula</span>, <span class="no">data</span>) {
    <span class="no">result</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span>(<span class="no">formula</span>, <span class="no">data</span>))
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
        <span class="kw">p.value</span><span class="kw">=</span><span class="no">result</span><span class="kw">[[</span><span class="fl">1</span>]]<span class="kw">[[</span><span class="st">'Pr(&gt;F)'</span>]]<span class="kw">[[</span><span class="fl">1</span>]],
        <span class="kw">method</span><span class="kw">=</span><span class="st">'Analysis of variance Pr(&gt;F)'</span>,
        <span class="kw">statistic</span><span class="kw">=</span><span class="no">result</span><span class="kw">[[</span><span class="fl">1</span>]]<span class="kw">[[</span><span class="st">'F value'</span>]]<span class="kw">[[</span><span class="fl">1</span>]]
    )
}

<span class="no">custom_tests</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="kw">mpaa</span><span class="kw">=</span><span class="no">chisq_from_formula</span>,
    <span class="kw">budget</span><span class="kw">=</span><span class="no">anova_single</span>
)</pre></body></html></div>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="fu"><a href="../reference/upset_test.html">upset_test</a></span>(<span class="no">movies</span>, <span class="no">genres</span>, <span class="kw">tests</span><span class="kw">=</span><span class="no">custom_tests</span>))</pre></body></html></div>
<pre><code>Warning message in chisq.test(ftable(formula, data)):
“Chi-squared approximation may be incorrect”


[1] "year, length, budget, rating, votes, r1, r2, r3, r4, r5, r6, r7, r8, r9, r10, mpaa differ significantly between intersections"</code></pre>
<table class="table">
<caption>
A data.frame: 6 × 5
</caption>
<thead>
<tr>
<th>
</th>
<th scope="col">
variable
</th>
<th scope="col">
p.value
</th>
<th scope="col">
statistic
</th>
<th scope="col">
test
</th>
<th scope="col">
fdr
</th>
</tr>
<tr>
<th>
</th>
<th scope="col">
&lt;fct&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;fct&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
</tr>
</thead>
<tbody>
<tr>
<th scope="row">
length
</th>
<td>
length
</td>
<td>
6.511525e-71
</td>
<td>
422.88444
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
1.106959e-69
</td>
</tr>
<tr>
<th scope="row">
budget
</th>
<td>
budget
</td>
<td>
1.348209e-60
</td>
<td>
13.66395
</td>
<td>
Analysis of variance Pr(&gt;F)
</td>
<td>
1.145977e-59
</td>
</tr>
<tr>
<th scope="row">
rating
</th>
<td>
rating
</td>
<td>
1.209027e-46
</td>
<td>
301.72764
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
6.851151e-46
</td>
</tr>
<tr>
<th scope="row">
mpaa
</th>
<td>
mpaa
</td>
<td>
9.799097e-42
</td>
<td>
406.33814
</td>
<td>
Pearson’s Chi-squared test
</td>
<td>
4.164616e-41
</td>
</tr>
<tr>
<th scope="row">
r8
</th>
<td>
r8
</td>
<td>
9.900004e-39
</td>
<td>
261.28815
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
3.366002e-38
</td>
</tr>
<tr>
<th scope="row">
r9
</th>
<td>
r9
</td>
<td>
1.433256e-30
</td>
<td>
218.78160
</td>
<td>
Kruskal-Wallis rank sum test
</td>
<td>
4.060891e-30
</td>
</tr>
</tbody>
</table>
<p>Many tests will require at least two observations in each group. You can skip intersections with less than two members with <code>min_size=2</code>.</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">bartlett_results</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span>(
    <span class="fu"><a href="../reference/upset_test.html">upset_test</a></span>(<span class="no">movies</span>, <span class="no">genres</span>, <span class="kw">test</span><span class="kw">=</span><span class="no">bartlett.test</span>, <span class="kw">min_size</span><span class="kw">=</span><span class="fl">2</span>)
)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span>(<span class="no">bartlett_results</span>)</pre></body></html></div>
<pre><code>[1] "NA, year, length, budget, rating, votes, r1, r2, r3, r4, r5, r6, r7, r8, r9, r10, NA differ significantly between intersections"</code></pre>
<table class="table">
<caption>
A data.frame: 6 × 5
</caption>
<thead>
<tr>
<th>
</th>
<th scope="col">
variable
</th>
<th scope="col">
p.value
</th>
<th scope="col">
statistic
</th>
<th scope="col">
test
</th>
<th scope="col">
fdr
</th>
</tr>
<tr>
<th>
</th>
<th scope="col">
&lt;fct&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;fct&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
</tr>
</thead>
<tbody>
<tr>
<th scope="row">
year
</th>
<td>
year
</td>
<td>
1.041955e-67
</td>
<td>
386.53699
</td>
<td>
Bartlett test of homogeneity of variances
</td>
<td>
1.302444e-67
</td>
</tr>
<tr>
<th scope="row">
length
</th>
<td>
length
</td>
<td>
3.982729e-67
</td>
<td>
383.70148
</td>
<td>
Bartlett test of homogeneity of variances
</td>
<td>
4.595457e-67
</td>
</tr>
<tr>
<th scope="row">
budget
</th>
<td>
budget
</td>
<td>
7.637563e-50
</td>
<td>
298.89911
</td>
<td>
Bartlett test of homogeneity of variances
</td>
<td>
8.183103e-50
</td>
</tr>
<tr>
<th scope="row">
rating
</th>
<td>
rating
</td>
<td>
3.980194e-06
</td>
<td>
66.63277
</td>
<td>
Bartlett test of homogeneity of variances
</td>
<td>
3.980194e-06
</td>
</tr>
<tr>
<th scope="row">
title
</th>
<td>
title
</td>
<td>
NA
</td>
<td>
NA
</td>
<td>
Bartlett test of homogeneity of variances
</td>
<td>
NA
</td>
</tr>
<tr>
<th scope="row">
mpaa
</th>
<td>
mpaa
</td>
<td>
NA
</td>
<td>
NA
</td>
<td>
Bartlett test of homogeneity of variances
</td>
<td>
NA
</td>
</tr>
</tbody>
</table>
<div id="ignore-specific-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#ignore-specific-variables" class="anchor"></a>2.1 Ignore specific variables</h3>
<p>You may want to exclude variables which are: - highly correlated and therefore interfering with the FDR calculation, or - simply irrelevant</p>
<p>In the movies example, the title variable is not a reasonable thing to compare. We can ignore it using:</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="co"># note: title no longer present</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="fu"><a href="../reference/upset_test.html">upset_test</a></span>(<span class="no">movies</span>, <span class="no">genres</span>, <span class="kw">ignore</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'title'</span>)))</pre></body></html></div>
<pre><code>[1] "year, length, budget, rating, votes, r1, r2, r3, r4, r5, r6, r7, r8, r9, r10, mpaa differ significantly between intersections"</code></pre>
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline">
<li>
‘length’
</li>
<li>
‘rating’
</li>
<li>
‘budget’
</li>
<li>
‘r8’
</li>
<li>
‘mpaa’
</li>
<li>
‘r9’
</li>
<li>
‘r1’
</li>
<li>
‘r4’
</li>
<li>
‘r3’
</li>
<li>
‘r5’
</li>
<li>
‘r7’
</li>
<li>
‘r2’
</li>
<li>
‘r10’
</li>
<li>
‘votes’
</li>
<li>
‘r6’
</li>
<li>
‘year’
</li>
</ol>
</div>
</div>
<div id="adjusting-intersection-size" class="section level2">
<h2 class="hasAnchor">
<a href="#adjusting-intersection-size" class="anchor"></a>3. Adjusting “Intersection size”</h2>
<div id="counts" class="section level3">
<h3 class="hasAnchor">
<a href="#counts" class="anchor"></a>3.1 Counts</h3>
<p>The counts over the bars can be disabled:</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">3</span>)

<span class="fu"><a href="../reference/upset.html">upset</a></span>(
    <span class="no">movies</span>,
    <span class="no">genres</span>,
    <span class="kw">base_annotations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
        <span class="st">'Intersection size'</span><span class="kw">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span>(<span class="kw">counts</span><span class="kw">=</span><span class="fl">FALSE</span>)
    ),
    <span class="kw">min_size</span><span class="kw">=</span><span class="fl">10</span>,
    <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.1</span>
)</pre></body></html></div>
<pre><code>[1] "Dropping empty groups: Short"</code></pre>
<p><img src="Examples_R_files/Examples_R_37_1.png"></p>
<p>The colors can be changed:</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">3</span>)

<span class="fu"><a href="../reference/upset.html">upset</a></span>(
    <span class="no">movies</span>,
    <span class="no">genres</span>,
    <span class="kw">base_annotations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
        <span class="st">'Intersection size'</span><span class="kw">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span>(
            <span class="kw">text_colors</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
                <span class="kw">on_background</span><span class="kw">=</span><span class="st">'brown'</span>, <span class="kw">on_bar</span><span class="kw">=</span><span class="st">'yellow'</span>
            )
        )
    ),
    <span class="kw">min_size</span><span class="kw">=</span><span class="fl">10</span>,
    <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.1</span>
)</pre></body></html></div>
<pre><code>[1] "Dropping empty groups: Short"</code></pre>
<p><img src="Examples_R_files/Examples_R_39_1.png"></p>
<p>Any parameter supported by <code>geom_text</code> can be passed in <code>text</code> list:</p>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">3</span>)

<span class="fu"><a href="../reference/upset.html">upset</a></span>(
    <span class="no">movies</span>,
    <span class="no">genres</span>,
    <span class="kw">base_annotations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
        <span class="st">'Intersection size'</span><span class="kw">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span>(
            <span class="kw">text</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
                <span class="kw">vjust</span><span class="kw">=</span>-<span class="fl">0.1</span>,
                <span class="kw">hjust</span><span class="kw">=</span>-<span class="fl">0.1</span>,
                <span class="kw">angle</span><span class="kw">=</span><span class="fl">45</span>
            )
        )
    ),
    <span class="kw">min_size</span><span class="kw">=</span><span class="fl">10</span>,
    <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.1</span>
)</pre></body></html></div>
<pre><code>[1] "Dropping empty groups: Short"</code></pre>
<p><img src="Examples_R_files/Examples_R_41_1.png"></p>
</div>
<div id="fill-the-bars" class="section level3">
<h3 class="hasAnchor">
<a href="#fill-the-bars" class="anchor"></a>3.2 Fill the bars</h3>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">3</span>)

<span class="fu"><a href="../reference/upset.html">upset</a></span>(
    <span class="no">movies</span>,
    <span class="no">genres</span>,
    <span class="kw">base_annotations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
        <span class="st">'Intersection size'</span><span class="kw">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span>(
            <span class="kw">counts</span><span class="kw">=</span><span class="fl">FALSE</span>,
            <span class="kw">aes</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">fill</span><span class="kw">=</span><span class="no">mpaa</span>)
        )
    ),
    <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.1</span>
)</pre></body></html></div>
<p><img src="Examples_R_files/Examples_R_43_0.png"></p>
</div>
<div id="adjusting-the-height-of-the-matrixintersection-size" class="section level3">
<h3 class="hasAnchor">
<a href="#adjusting-the-height-of-the-matrixintersection-size" class="anchor"></a>3.3 Adjusting the height of the matrix/intersection size</h3>
<p>Setting <code>height_ratio=1</code> will cause the intersection matrix and the intersection size to have an equal height:</p>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">3</span>)

<span class="fu"><a href="../reference/upset.html">upset</a></span>(
    <span class="no">movies</span>,
    <span class="no">genres</span>,
    <span class="kw">height_ratio</span><span class="kw">=</span><span class="fl">1</span>,
    <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.1</span>
)</pre></body></html></div>
<p><img src="Examples_R_files/Examples_R_46_0.png"></p>
</div>
<div id="hiding-intersection-size" class="section level3">
<h3 class="hasAnchor">
<a href="#hiding-intersection-size" class="anchor"></a>3.5 Hiding intersection size</h3>
<p>You can always disable the intersection size altogether:</p>
<div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">1.6</span>)
<span class="fu"><a href="../reference/upset.html">upset</a></span>(
    <span class="no">movies</span>,
    <span class="no">genres</span>,
    <span class="kw">base_annotations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(),
    <span class="kw">min_size</span><span class="kw">=</span><span class="fl">10</span>,
    <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.1</span>
)</pre></body></html></div>
<pre><code>[1] "Dropping empty groups: Short"</code></pre>
<p><img src="Examples_R_files/Examples_R_49_1.png"></p>
</div>
<div id="showing-intersection-sizeunion-size-ratio" class="section level3">
<h3 class="hasAnchor">
<a href="#showing-intersection-sizeunion-size-ratio" class="anchor"></a>3.6 Showing intersection size/union size ratio</h3>
<p>While this cannot be computed for the null intersection (observations which do not belong to either of the groups), it is usefull to visualise which intersections might be large due to the chance (i.e. corrsponding groups being proportionally larger) alone:</p>
<div class="sourceCode" id="cb34"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">6</span>)
<span class="fu"><a href="../reference/upset.html">upset</a></span>(
    <span class="no">movies</span>, <span class="no">genres</span>, <span class="kw">name</span><span class="kw">=</span><span class="st">'genre'</span>, <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.1</span>, <span class="kw">min_size</span><span class="kw">=</span><span class="fl">10</span>,
    <span class="kw">base_annotations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
        <span class="st">'Intersection size'</span><span class="kw">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span>(),
        <span class="st">'Intersection ratio'</span><span class="kw">=</span><span class="fu"><a href="../reference/intersection_ratio.html">intersection_ratio</a></span>()
    )
)</pre></body></html></div>
<pre><code>[1] "Dropping empty groups: Short"</code></pre>
<p><img src="Examples_R_files/Examples_R_52_1.png"></p>
<p>The plot above tells us that the analysed documentary movies are always documentaries (and nothing more!), while comedies more often include elements of other genres (e.g. drama, romance) rather than being comedies alone (like stand-up shows).</p>
</div>
<div id="showing-percentages" class="section level3">
<h3 class="hasAnchor">
<a href="#showing-percentages" class="anchor"></a>3.7 Showing percentages</h3>
<p><code>text_aes</code> can be used to manipulate the aesthetics of the labels. Using the <code>intersection_size</code> and <code>union_size</code> one can calculate percentage of items in the intersection (relative to the potential size of the intersection). A <code><a href="../reference/upset_text_percentage.html">upset_text_percentage(digits=0, sep='')</a></code> shorthand is provided for convenience; please note that it has to be used with <code>aes_</code> rather than <code>aes</code>:</p>
<div class="sourceCode" id="cb36"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">6</span>)
<span class="fu"><a href="../reference/upset.html">upset</a></span>(
    <span class="no">movies</span>, <span class="no">genres</span>, <span class="kw">name</span><span class="kw">=</span><span class="st">'genre'</span>, <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.1</span>, <span class="kw">min_size</span><span class="kw">=</span><span class="fl">10</span>,
    <span class="kw">base_annotations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
        <span class="co"># with manual aes specification:</span>
        <span class="st">'Intersection size'</span><span class="kw">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span>(<span class="kw">text_aes</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">label</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="no">intersection_size</span>/<span class="no">union_size</span> * <span class="fl">100</span>), <span class="st">'%'</span>))),
        <span class="co"># using shorthand:</span>
        <span class="st">'Intersection ratio'</span><span class="kw">=</span><span class="fu"><a href="../reference/intersection_ratio.html">intersection_ratio</a></span>(<span class="kw">text_aes</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html">aes_</a></span>(<span class="kw">label</span><span class="kw">=</span><span class="fu"><a href="../reference/upset_text_percentage.html">upset_text_percentage</a></span>()))
    )
)</pre></body></html></div>
<pre><code>[1] "Dropping empty groups: Short"</code></pre>
<p><img src="Examples_R_files/Examples_R_56_1.png"></p>
</div>
</div>
<div id="adjusting-set-size" class="section level2">
<h2 class="hasAnchor">
<a href="#adjusting-set-size" class="anchor"></a>4. Adjusting “set size”</h2>
<div id="rotate-labels" class="section level3">
<h3 class="hasAnchor">
<a href="#rotate-labels" class="anchor"></a>4.1 Rotate labels</h3>
<p>To rotate the labels modify correposnding theme:</p>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">4</span>, <span class="fl">3</span>)
<span class="fu"><a href="../reference/upset.html">upset</a></span>(
    <span class="no">movies</span>, <span class="no">genres</span>,
    <span class="kw">min_size</span><span class="kw">=</span><span class="fl">100</span>,
    <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.15</span>,
    <span class="kw">themes</span><span class="kw">=</span><span class="fu"><a href="../reference/upset_modify_themes.html">upset_modify_themes</a></span>(
        <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
            <span class="st">'overall_sizes'</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.text.x</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">angle</span><span class="kw">=</span><span class="fl">90</span>))
        )
    )
)</pre></body></html></div>
<pre><code>[1] "Dropping empty groups: Animation, Documentary, Short"</code></pre>
<p><img src="Examples_R_files/Examples_R_60_1.png"></p>
<p>To display the ticks:</p>
<div class="sourceCode" id="cb40"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">4</span>, <span class="fl">3</span>)
<span class="fu"><a href="../reference/upset.html">upset</a></span>(
    <span class="no">movies</span>, <span class="no">genres</span>, <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.3</span>, <span class="kw">min_size</span><span class="kw">=</span><span class="fl">100</span>, <span class="kw">wrap</span><span class="kw">=</span><span class="fl">TRUE</span>,
    <span class="kw">themes</span><span class="kw">=</span><span class="fu"><a href="../reference/upset_modify_themes.html">upset_modify_themes</a></span>(
        <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
            <span class="st">'overall_sizes'</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.ticks.x</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span>())
        )
    )
)</pre></body></html></div>
<pre><code>[1] "Dropping empty groups: Animation, Documentary, Short"</code></pre>
<p><img src="Examples_R_files/Examples_R_62_1.png"></p>
</div>
<div id="modify-geoms-and-other-layers" class="section level3">
<h3 class="hasAnchor">
<a href="#modify-geoms-and-other-layers" class="anchor"></a>4.2 Modify geoms and other layers</h3>
<p>Arguments of the <code>geom_bar</code> can be passed to <code>upset_set_size</code>; it can even use a different geom, or be replaced with a custom list of layers altogether:</p>
<div class="sourceCode" id="cb42"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">3</span>)

(
    <span class="fu"><a href="../reference/upset.html">upset</a></span>(
        <span class="no">movies</span>, <span class="no">genres</span>, <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.5</span>, <span class="kw">max_size</span><span class="kw">=</span><span class="fl">100</span>, <span class="kw">min_size</span><span class="kw">=</span><span class="fl">15</span>, <span class="kw">wrap</span><span class="kw">=</span><span class="fl">TRUE</span>,
        <span class="kw">set_sizes</span><span class="kw">=</span><span class="fu"><a href="../reference/upset_set_size.html">upset_set_size</a></span>(
            <span class="kw">width</span><span class="kw">=</span><span class="fl">0.4</span>
        )
    )
    +
    <span class="fu"><a href="../reference/upset.html">upset</a></span>(
        <span class="no">movies</span>, <span class="no">genres</span>, <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.5</span>, <span class="kw">max_size</span><span class="kw">=</span><span class="fl">100</span>, <span class="kw">min_size</span><span class="kw">=</span><span class="fl">15</span>, <span class="kw">wrap</span><span class="kw">=</span><span class="fl">TRUE</span>,
        <span class="kw">set_sizes</span><span class="kw">=</span><span class="fu"><a href="../reference/upset_set_size.html">upset_set_size</a></span>(
            <span class="kw">geom</span><span class="kw">=</span><span class="no">geom_point</span>,
            <span class="kw">stat</span><span class="kw">=</span><span class="st">'count'</span>,
            <span class="kw">color</span><span class="kw">=</span><span class="st">'blue'</span>
        )
    )
    +
    <span class="fu"><a href="../reference/upset.html">upset</a></span>(
        <span class="no">movies</span>, <span class="no">genres</span>, <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.5</span>, <span class="kw">max_size</span><span class="kw">=</span><span class="fl">100</span>, <span class="kw">min_size</span><span class="kw">=</span><span class="fl">15</span>, <span class="kw">wrap</span><span class="kw">=</span><span class="fl">TRUE</span>,
        <span class="kw">set_sizes</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">y</span><span class="kw">=</span><span class="no">..count..</span>/<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">..count..</span>)), <span class="kw">stat</span><span class="kw">=</span><span class="st">'count'</span>),
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="st">'Size relative to the largest'</span>),
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_reverse</a></span>()
        )
    )
)</pre></body></html></div>
<pre><code>[1] "Dropping empty groups: Documentary, Short"
[1] "Dropping empty groups: Documentary, Short"
[1] "Dropping empty groups: Documentary, Short"</code></pre>
<p><img src="Examples_R_files/Examples_R_65_1.png"></p>
</div>
<div id="logarithmic-scale" class="section level3">
<h3 class="hasAnchor">
<a href="#logarithmic-scale" class="anchor"></a>4.3 Logarithmic scale</h3>
<p>In order to use a log scale we need pass additional scale to in <code>layers</code> argument. However, as the bars are on flipped coordinates, we need a reversed log transformation:</p>
<div class="sourceCode" id="cb44"><html><body><pre class="r"><span class="no">reverse_log_trans</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">base</span><span class="kw">=</span><span class="fl">10</span>) {
    <span class="co"># CC-BY-SA 4.0 Brian Diggs, modified</span>
    <span class="co"># https://stackoverflow.com/a/11054781</span>
    <span class="kw pkg">scales</span><span class="kw ns">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/trans_new.html">trans_new</a></span>(
        <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(
            <span class="st">'reverselog-'</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span>(<span class="no">base</span>)),
            <span class="kw">function</span>(<span class="no">x</span>) -<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">x</span>, <span class="no">base</span>),
            <span class="kw">function</span>(<span class="no">x</span>) <span class="no">base</span>^-<span class="no">x</span>,
            <span class="kw pkg">scales</span><span class="kw ns">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/breaks_log.html">log_breaks</a></span>(<span class="kw">base</span><span class="kw">=</span><span class="no">base</span>),
            <span class="kw">domain</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e-100</span>, <span class="fl">Inf</span>)
    )
}</pre></body></html></div>
<p>Which is then easy to apply:</p>
<div class="sourceCode" id="cb45"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">5</span>, <span class="fl">3</span>)

<span class="fu"><a href="../reference/upset.html">upset</a></span>(
    <span class="no">movies</span>, <span class="no">genres</span>,
    <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.1</span>,
    <span class="kw">min_size</span><span class="kw">=</span><span class="fl">10</span>,
    <span class="kw">set_sizes</span><span class="kw">=</span><span class="fu"><a href="../reference/upset_set_size.html">upset_set_size</a></span>(
        <span class="kw">width</span><span class="kw">=</span><span class="fl">0.4</span>,
        <span class="kw">layers</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="kw">trans</span><span class="kw">=</span><span class="fu">reverse_log_trans</span>())
        )
    ),
    <span class="kw">themes</span><span class="kw">=</span><span class="fu"><a href="../reference/upset_modify_themes.html">upset_modify_themes</a></span>(
        <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">'overall_sizes'</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.text.x</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">angle</span><span class="kw">=</span><span class="fl">90</span>)))
    ),
    <span class="kw">queries</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="../reference/upset_query.html">upset_query</a></span>(<span class="kw">set</span><span class="kw">=</span><span class="st">'Drama'</span>, <span class="kw">fill</span><span class="kw">=</span><span class="st">'blue'</span>))
)</pre></body></html></div>
<pre><code>[1] "Dropping empty groups: Short"


Scale for 'y' is already present. Adding another scale for 'y', which will
replace the existing scale.

Warning message in self$trans$transform(x):
“NaNs produced”
Warning message:
“Removed 72 rows containing missing values (geom_segment).”</code></pre>
<p><img src="Examples_R_files/Examples_R_70_2.png"></p>
<p>We can also modify the labels to display the logged values:</p>
<div class="sourceCode" id="cb47"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">5</span>, <span class="fl">3</span>)

<span class="fu"><a href="../reference/upset.html">upset</a></span>(
    <span class="no">movies</span>, <span class="no">genres</span>,
    <span class="kw">min_size</span><span class="kw">=</span><span class="fl">10</span>,
    <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.2</span>,
    <span class="kw">set_sizes</span><span class="kw">=</span><span class="fu"><a href="../reference/upset_set_size.html">upset_set_size</a></span>(
        <span class="kw">width</span><span class="kw">=</span><span class="fl">0.4</span>,
        <span class="kw">layers</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(
                <span class="kw">trans</span><span class="kw">=</span><span class="fu">reverse_log_trans</span>(),
                <span class="kw">labels</span><span class="kw">=</span><span class="no">log10</span>
            ),
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="st">'log10(set size)'</span>)
        )
    )
)</pre></body></html></div>
<pre><code>[1] "Dropping empty groups: Short"


Scale for 'y' is already present. Adding another scale for 'y', which will
replace the existing scale.

Warning message in self$trans$transform(x):
“NaNs produced”
Warning message:
“Removed 72 rows containing missing values (geom_segment).”</code></pre>
<p><img src="Examples_R_files/Examples_R_72_2.png"></p>
</div>
<div id="hide-the-set-sizes-altogether" class="section level3">
<h3 class="hasAnchor">
<a href="#hide-the-set-sizes-altogether" class="anchor"></a>4.4 Hide the set sizes altogether</h3>
<div class="sourceCode" id="cb49"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">5</span>, <span class="fl">3</span>)

<span class="fu"><a href="../reference/upset.html">upset</a></span>(
    <span class="no">movies</span>, <span class="no">genres</span>,
    <span class="kw">min_size</span><span class="kw">=</span><span class="fl">10</span>,
    <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.2</span>,
    <span class="kw">set_sizes</span><span class="kw">=</span><span class="fl">FALSE</span>
)</pre></body></html></div>
<pre><code>[1] "Dropping empty groups: Short"</code></pre>
<p><img src="Examples_R_files/Examples_R_74_1.png"></p>
</div>
</div>
<div id="adjusting-other-aesthetics" class="section level2">
<h2 class="hasAnchor">
<a href="#adjusting-other-aesthetics" class="anchor"></a>5. Adjusting other aesthetics</h2>
<div id="stripes" class="section level3">
<h3 class="hasAnchor">
<a href="#stripes" class="anchor"></a>Stripes</h3>
<div class="sourceCode" id="cb51"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">4</span>)
<span class="fu"><a href="../reference/upset.html">upset</a></span>(
    <span class="no">movies</span>,
    <span class="no">genres</span>,
    <span class="kw">stripes</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'cornsilk1'</span>, <span class="st">'deepskyblue1'</span>),
    <span class="kw">min_size</span><span class="kw">=</span><span class="fl">10</span>
)</pre></body></html></div>
<pre><code>[1] "Dropping empty groups: Short"</code></pre>
<p><img src="Examples_R_files/Examples_R_77_1.png"></p>
<p>To effectively disable the stripes:</p>
<div class="sourceCode" id="cb53"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">4</span>)
<span class="fu"><a href="../reference/upset.html">upset</a></span>(
    <span class="no">movies</span>,
    <span class="no">genres</span>,
    <span class="kw">stripes</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'white'</span>, <span class="st">'white'</span>),
    <span class="kw">min_size</span><span class="kw">=</span><span class="fl">10</span>
)</pre></body></html></div>
<pre><code>[1] "Dropping empty groups: Short"</code></pre>
<p><img src="Examples_R_files/Examples_R_79_1.png"></p>
</div>
<div id="adding-title" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-title" class="anchor"></a>Adding title</h3>
<p>Adding title with <code>ggtitle</code> with add it to the intesection matrix:</p>
<div class="sourceCode" id="cb55"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">4</span>)
<span class="fu"><a href="../reference/upset.html">upset</a></span>(<span class="no">movies</span>, <span class="no">genres</span>, <span class="kw">min_size</span><span class="kw">=</span><span class="fl">10</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">'Intersection matrix title'</span>)</pre></body></html></div>
<pre><code>[1] "Dropping empty groups: Short"</code></pre>
<p><img src="Examples_R_files/Examples_R_82_1.png"></p>
<p>In order to add a title for the entire plot, you need to wrap the plot:</p>
<div class="sourceCode" id="cb57"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">4</span>)
<span class="fu"><a href="../reference/upset.html">upset</a></span>(<span class="no">movies</span>, <span class="no">genres</span>, <span class="kw">min_size</span><span class="kw">=</span><span class="fl">10</span>, <span class="kw">wrap</span><span class="kw">=</span><span class="fl">TRUE</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">'The overlap between genres'</span>)</pre></body></html></div>
<pre><code>[1] "Dropping empty groups: Short"</code></pre>
<p><img src="Examples_R_files/Examples_R_84_1.png"></p>
</div>
</div>
<div id="themes" class="section level2">
<h2 class="hasAnchor">
<a href="#themes" class="anchor"></a>6. Themes</h2>
<p>The themes for specific components are defined in <code>upset_themes</code> list, which contains themes for:</p>
<div class="sourceCode" id="cb59"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">upset_themes</span>)</pre></body></html></div>
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline">
<li>
‘intersections_matrix’
</li>
<li>
‘Intersection size’
</li>
<li>
‘overall_sizes’
</li>
<li>
‘default’
</li>
</ol>
<p>You can substitute this list for your own using <code>themes</code> argument. While you can specify a theme for every component, if you omit one or more components those will be taken from the element named <code>default</code>.</p>
<div id="substituting-themes" class="section level3">
<h3 class="hasAnchor">
<a href="#substituting-themes" class="anchor"></a>6.1 Substituting themes</h3>
<div class="sourceCode" id="cb60"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">4</span>)
<span class="fu"><a href="../reference/upset.html">upset</a></span>(<span class="no">movies</span>, <span class="no">genres</span>, <span class="kw">min_size</span><span class="kw">=</span><span class="fl">10</span>, <span class="kw">themes</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">default</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>()))</pre></body></html></div>
<pre><code>[1] "Dropping empty groups: Short"</code></pre>
<p><img src="Examples_R_files/Examples_R_90_1.png"></p>
<p>You can also add themes for your custom panels/annotations:</p>
<div class="sourceCode" id="cb62"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">8</span>)

<span class="fu"><a href="../reference/upset.html">upset</a></span>(
    <span class="no">movies</span>,
    <span class="no">genres</span>,
    <span class="kw">annotations</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
        <span class="st">'Length'</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
            <span class="kw">aes</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">intersection</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">length</span>),
            <span class="kw">geom</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span>()
        ),
        <span class="st">'Rating'</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
            <span class="kw">aes</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">intersection</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">rating</span>),
            <span class="kw">geom</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">color</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(<span class="no">votes</span>))),
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span>(<span class="kw">width</span><span class="kw">=</span><span class="fl">1.1</span>, <span class="kw">alpha</span><span class="kw">=</span><span class="fl">0.5</span>)
            )
        )
    ),
    <span class="kw">min_size</span><span class="kw">=</span><span class="fl">10</span>,
    <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.1</span>,
    <span class="kw">themes</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/utils/modifyList.html">modifyList</a></span>(
        <span class="no">upset_themes</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">Rating</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span>(), <span class="kw">Length</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>())
    )
)</pre></body></html></div>
<pre><code>[1] "Dropping empty groups: Short"


Warning message:
“position_dodge requires non-overlapping x intervals”</code></pre>
<p><img src="Examples_R_files/Examples_R_92_2.png"></p>
</div>
<div id="adjusting-the-default-themes" class="section level3">
<h3 class="hasAnchor">
<a href="#adjusting-the-default-themes" class="anchor"></a>6.2 Adjusting the default themes</h3>
<p>Modify all the default themes as once with <code><a href="../reference/upset_default_themes.html">upset_default_themes()</a></code>:</p>
<div class="sourceCode" id="cb64"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">4</span>)

<span class="fu"><a href="../reference/upset.html">upset</a></span>(
    <span class="no">movies</span>, <span class="no">genres</span>, <span class="kw">min_size</span><span class="kw">=</span><span class="fl">10</span>, <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.1</span>,
    <span class="kw">themes</span><span class="kw">=</span><span class="fu"><a href="../reference/upset_default_themes.html">upset_default_themes</a></span>(<span class="kw">text</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">color</span><span class="kw">=</span><span class="st">'red'</span>))
)</pre></body></html></div>
<pre><code>[1] "Dropping empty groups: Short"</code></pre>
<p><img src="Examples_R_files/Examples_R_95_1.png"></p>
<p>To modify only a subset of default themes use <code><a href="../reference/upset_modify_themes.html">upset_modify_themes()</a></code>:</p>
<div class="sourceCode" id="cb66"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">4</span>)

<span class="fu"><a href="../reference/upset.html">upset</a></span>(
    <span class="no">movies</span>, <span class="no">genres</span>,
    <span class="kw">base_annotations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">'Intersection size'</span><span class="kw">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span>(<span class="kw">counts</span><span class="kw">=</span><span class="fl">FALSE</span>)),
    <span class="kw">min_size</span><span class="kw">=</span><span class="fl">100</span>,
    <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.1</span>,
    <span class="kw">themes</span><span class="kw">=</span><span class="fu"><a href="../reference/upset_modify_themes.html">upset_modify_themes</a></span>(
        <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
            <span class="st">'intersections_matrix'</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">text</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span><span class="kw">=</span><span class="fl">20</span>)),
            <span class="st">'overall_sizes'</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.text.x</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">angle</span><span class="kw">=</span><span class="fl">90</span>))
        )
    )
)</pre></body></html></div>
<pre><code>[1] "Dropping empty groups: Animation, Documentary, Short"</code></pre>
<p><img src="Examples_R_files/Examples_R_97_1.png"></p>
</div>
</div>
<div id="highlighting-queries" class="section level2">
<h2 class="hasAnchor">
<a href="#highlighting-queries" class="anchor"></a>7. Highlighting (queries)</h2>
<p>Pass a list of lists generated with <code><a href="../reference/upset_query.html">upset_query()</a></code> utility to the optional <code>queries</code> argument to selectively modify aesthetics of specific intersections or sets.</p>
<p>Use one of the arguments: <code>set</code> or <code>intersection</code> (not both) to specify what to highlight: - <code>set</code> will highlight the bar of the set size, - <code>intersection</code> will highlight an intersection on all components (by default), or on components chosen with <code>only_components</code> - all other parameters will be used to modify the geoms</p>
<div class="sourceCode" id="cb68"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">6</span>)

<span class="fu"><a href="../reference/upset.html">upset</a></span>(
    <span class="no">movies</span>, <span class="no">genres</span>, <span class="kw">name</span><span class="kw">=</span><span class="st">'genre'</span>, <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.1</span>, <span class="kw">min_size</span><span class="kw">=</span><span class="fl">10</span>,
    <span class="kw">annotations</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
        <span class="st">'Length'</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
            <span class="kw">aes</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">intersection</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">length</span>),
            <span class="kw">geom</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span>()
        )
    ),
    <span class="kw">queries</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
        <span class="fu"><a href="../reference/upset_query.html">upset_query</a></span>(
            <span class="kw">intersect</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'Drama'</span>, <span class="st">'Comedy'</span>),
            <span class="kw">color</span><span class="kw">=</span><span class="st">'red'</span>,
            <span class="kw">fill</span><span class="kw">=</span><span class="st">'red'</span>,
            <span class="kw">only_components</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'intersections_matrix'</span>, <span class="st">'Intersection size'</span>)
        ),
        <span class="fu"><a href="../reference/upset_query.html">upset_query</a></span>(
            <span class="kw">set</span><span class="kw">=</span><span class="st">'Drama'</span>,
            <span class="kw">fill</span><span class="kw">=</span><span class="st">'blue'</span>
        ),
        <span class="fu"><a href="../reference/upset_query.html">upset_query</a></span>(
            <span class="kw">intersect</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'Romance'</span>, <span class="st">'Comedy'</span>),
            <span class="kw">fill</span><span class="kw">=</span><span class="st">'yellow'</span>,
            <span class="kw">only_components</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'Length'</span>)
        )
    )
)</pre></body></html></div>
<pre><code>[1] "Dropping empty groups: Short"


Warning message in (function (..., deparse.level = 1) :
“number of columns of result is not a multiple of vector length (arg 2)”
Warning message:
“Duplicated aesthetics after name standardisation: na.rm, orientation”
Warning message in (function (..., deparse.level = 1) :
“number of columns of result is not a multiple of vector length (arg 2)”
Warning message:
“Duplicated aesthetics after name standardisation: width, na.rm, orientation”
Warning message:
“Duplicated aesthetics after name standardisation: na.rm”
Warning message in grid.Call.graphics(C_rect, x$x, x$y, x$width, x$height, resolveHJust(x$just, :
“supplied color is neither numeric nor character”</code></pre>
<p><img src="Examples_R_files/Examples_R_100_2.png"></p>
</div>
<div id="sorting" class="section level2">
<h2 class="hasAnchor">
<a href="#sorting" class="anchor"></a>8. Sorting</h2>
<div id="sorting-intersections" class="section level3">
<h3 class="hasAnchor">
<a href="#sorting-intersections" class="anchor"></a>8.1 Sorting intersections</h3>
<p>By degree:</p>
<div class="sourceCode" id="cb70"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">3</span>)
<span class="fu"><a href="../reference/upset.html">upset</a></span>(<span class="no">movies</span>, <span class="no">genres</span>, <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.1</span>, <span class="kw">sort_intersections_by</span><span class="kw">=</span><span class="st">'degree'</span>)</pre></body></html></div>
<p><img src="Examples_R_files/Examples_R_104_0.png"></p>
<p>By ratio:</p>
<div class="sourceCode" id="cb71"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">4</span>)
<span class="fu"><a href="../reference/upset.html">upset</a></span>(
    <span class="no">movies</span>, <span class="no">genres</span>, <span class="kw">name</span><span class="kw">=</span><span class="st">'genre'</span>, <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.1</span>, <span class="kw">min_size</span><span class="kw">=</span><span class="fl">10</span>,
    <span class="kw">sort_intersections_by</span><span class="kw">=</span><span class="st">'ratio'</span>,
    <span class="kw">base_annotations</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
        <span class="st">'Intersection size'</span><span class="kw">=</span><span class="fu"><a href="../reference/intersection_size.html">intersection_size</a></span>(<span class="kw">text_aes</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html">aes_</a></span>(<span class="kw">label</span><span class="kw">=</span><span class="fu"><a href="../reference/upset_text_percentage.html">upset_text_percentage</a></span>())),
        <span class="st">'Intersection ratio'</span><span class="kw">=</span><span class="fu"><a href="../reference/intersection_ratio.html">intersection_ratio</a></span>(<span class="kw">text_aes</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html">aes_</a></span>(<span class="kw">label</span><span class="kw">=</span><span class="fu"><a href="../reference/upset_text_percentage.html">upset_text_percentage</a></span>()))
    )
)</pre></body></html></div>
<pre><code>[1] "Dropping empty groups: Short"</code></pre>
<p><img src="Examples_R_files/Examples_R_106_1.png"></p>
<p>The other way around:</p>
<div class="sourceCode" id="cb73"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">3</span>)
<span class="fu"><a href="../reference/upset.html">upset</a></span>(<span class="no">movies</span>, <span class="no">genres</span>, <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.1</span>, <span class="kw">sort_intersections</span><span class="kw">=</span><span class="st">'ascending'</span>)</pre></body></html></div>
<p><img src="Examples_R_files/Examples_R_108_0.png"></p>
<p>Without any sorting:</p>
<div class="sourceCode" id="cb74"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">3</span>)
<span class="fu"><a href="../reference/upset.html">upset</a></span>(<span class="no">movies</span>, <span class="no">genres</span>, <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.1</span>, <span class="kw">sort_intersections</span><span class="kw">=</span><span class="fl">FALSE</span>)</pre></body></html></div>
<p><img src="Examples_R_files/Examples_R_110_0.png"></p>
</div>
<div id="sorting-sets" class="section level3">
<h3 class="hasAnchor">
<a href="#sorting-sets" class="anchor"></a>8.2 Sorting sets</h3>
<p>Ascending:</p>
<div class="sourceCode" id="cb75"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">3</span>)
<span class="fu"><a href="../reference/upset.html">upset</a></span>(<span class="no">movies</span>, <span class="no">genres</span>, <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.1</span>, <span class="kw">sort_sets</span><span class="kw">=</span><span class="st">'ascending'</span>)</pre></body></html></div>
<p><img src="Examples_R_files/Examples_R_113_0.png"></p>
<p>Without sorting - preserving the order as in genres:</p>
<div class="sourceCode" id="cb76"><html><body><pre class="r"><span class="no">genres</span></pre></body></html></div>
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline">
<li>
‘Action’
</li>
<li>
‘Animation’
</li>
<li>
‘Comedy’
</li>
<li>
‘Drama’
</li>
<li>
‘Documentary’
</li>
<li>
‘Romance’
</li>
<li>
‘Short’
</li>
</ol>
<div class="sourceCode" id="cb77"><html><body><pre class="r"><span class="fu">set_size</span>(<span class="fl">8</span>, <span class="fl">3</span>)
<span class="fu"><a href="../reference/upset.html">upset</a></span>(<span class="no">movies</span>, <span class="no">genres</span>, <span class="kw">width_ratio</span><span class="kw">=</span><span class="fl">0.1</span>, <span class="kw">sort_sets</span><span class="kw">=</span><span class="fl">FALSE</span>)</pre></body></html></div>
<p><img src="Examples_R_files/Examples_R_116_0.png"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Michał Krassowski.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
